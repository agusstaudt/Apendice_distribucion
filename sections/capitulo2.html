
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Capitulo 2 &#8212; Una herramienta práctica para trabajar con datos</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Capítulo 3" href="capitulo3.html" />
    <link rel="prev" title="Apéndices del Libro Pobreza y Desigualdad en Python" href="../intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logoCEDLAS.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Una herramienta práctica para trabajar con datos</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Apéndices del Libro Pobreza y Desigualdad en Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Capítulos
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Capitulo 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="capitulo3.html">
   Capítulo 3
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/agusstaudt/Apendice_distribucion/master?urlpath=tree/docs/sections/capitulo2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/agusstaudt/Apendice_distribucion"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/agusstaudt/Apendice_distribucion/issues/new?title=Issue%20on%20page%20%2Fsections/capitulo2.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/sections/capitulo2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#herramientas-para-el-analisis-distributivo">
   Herramientas para el análisis distributivo
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutina-de-python-para-replicar-el-apendice-en-la-practica-del-capitulo-2-de-pobreza-y-desigualdad-en-america-latina">
     Rutina de Python para replicar el “Apéndice en la Práctica” del capítulo 2 de Pobreza y Desigualdad en América Latina
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ultima-actualizacion-15-de-junio-de-2022">
     Ultima actualización: 15 de junio de 2022
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-inicial">
   Set inicial
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduccion-ejemplo-brasil">
   2.1 Introducción: ejemplo Brasil
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#histogramas">
   2.2 Histogramas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcion-de-distribucion">
   2.3 Función de distribución
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diagrama-de-pareto">
   2.4 Diagrama de Pareto
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#box-plot">
   2.5 Box-Plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#curva-de-lorenz">
   2.6 Curva de Lorenz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#curva-generalizada-de-lorenz">
   2.7 Curva Generalizada de Lorenz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#curva-de-incidencia-del-crecimiento">
   2.8 Curva de incidencia del crecimiento
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Capitulo 2</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#herramientas-para-el-analisis-distributivo">
   Herramientas para el análisis distributivo
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rutina-de-python-para-replicar-el-apendice-en-la-practica-del-capitulo-2-de-pobreza-y-desigualdad-en-america-latina">
     Rutina de Python para replicar el “Apéndice en la Práctica” del capítulo 2 de Pobreza y Desigualdad en América Latina
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ultima-actualizacion-15-de-junio-de-2022">
     Ultima actualización: 15 de junio de 2022
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-inicial">
   Set inicial
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduccion-ejemplo-brasil">
   2.1 Introducción: ejemplo Brasil
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#histogramas">
   2.2 Histogramas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcion-de-distribucion">
   2.3 Función de distribución
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diagrama-de-pareto">
   2.4 Diagrama de Pareto
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#box-plot">
   2.5 Box-Plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#curva-de-lorenz">
   2.6 Curva de Lorenz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#curva-generalizada-de-lorenz">
   2.7 Curva Generalizada de Lorenz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#curva-de-incidencia-del-crecimiento">
   2.8 Curva de incidencia del crecimiento
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="capitulo-2">
<h1>Capitulo 2<a class="headerlink" href="#capitulo-2" title="Permalink to this headline">#</a></h1>
<section id="herramientas-para-el-analisis-distributivo">
<h2>Herramientas para el análisis distributivo<a class="headerlink" href="#herramientas-para-el-analisis-distributivo" title="Permalink to this headline">#</a></h2>
<section id="rutina-de-python-para-replicar-el-apendice-en-la-practica-del-capitulo-2-de-pobreza-y-desigualdad-en-america-latina">
<h3>Rutina de Python para replicar el “Apéndice en la Práctica” del capítulo 2 de Pobreza y Desigualdad en América Latina<a class="headerlink" href="#rutina-de-python-para-replicar-el-apendice-en-la-practica-del-capitulo-2-de-pobreza-y-desigualdad-en-america-latina" title="Permalink to this headline">#</a></h3>
<p>Códigos escritos en base a los apéndices del libro “Pobreza y Desigualdad en América Latina” de Gasparini, Cicowiez y Sosa Escudero. El objeto de este material es reproducir la rutina de códigos para Stata presentada en el libro al lenguaje Python. Este material es sólo de carácter complementario a las explicaciones y detalles conceptuales que se presentan en el libro de texto y los apéndices.</p>
</section>
<section id="ultima-actualizacion-15-de-junio-de-2022">
<h3>Ultima actualización: 15 de junio de 2022<a class="headerlink" href="#ultima-actualizacion-15-de-junio-de-2022" title="Permalink to this headline">#</a></h3>
</section>
</section>
<hr class="docutils" />
<section id="set-inicial">
<h2>Set inicial<a class="headerlink" href="#set-inicial" title="Permalink to this headline">#</a></h2>
<p>Antes de comenzar, se cargan las librerías necesarias para poder desarrollar el capítulo.</p>
<ul class="simple">
<li><p><em>wget</em>: para descargar archivos. Lo debemos instalar con la sentencia <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span></code>.</p></li>
<li><p><em>zipfile</em>: para comprimir y descomprimir archivos zip.</p></li>
<li><p><em>os</em>: realizar consultas acerca de directorios o pedidos específicos al sistema opertivo.</p></li>
<li><p><em>pandas</em>: necesario para manipulación y análisis de datos.</p></li>
<li><p><em>matplotlib</em>: para visualización.</p></li>
<li><p><em>seaborn</em>: otra librería para visualización.</p></li>
<li><p><em>numpy</em>: para creación y manipulación de vectores y matrices. También presenta una gran colección de funciones matemáticas para operar con ellas.</p></li>
<li><p><em>math</em>: para utilizar también funciones matemáticas.</p></li>
<li><p><em>scipy</em>: herramientas y algoritmos matemáticos. contiene módulos para optimización, álgebra lineal, integración, interpolación, funciones especiales.</p></li>
<li><p><em>warnings</em>: configurar la presencia de advertencias que arrojan las funciones.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Importamos librerias</span>
<span class="o">!</span>pip install wget
<span class="kn">import</span> <span class="nn">wget</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">warnings</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: wget in c:\users\usuario\appdata\local\programs\python\python310\lib\site-packages (3.2)
</pre></div>
</div>
</div>
</div>
<p>Como se puede ver en la primer línea de códigos, hay diferentes formas de activar una librería o una función dentro de esta. En el caso en que esta se encuentre dentro de <em>python</em> podemos cargar la librería con <code class="docutils literal notranslate"><span class="pre">import</span></code>, <code class="docutils literal notranslate"><span class="pre">from...import...</span></code> para importar una función específica dentro de la librería. En el caso en que esta librería no se encuentre directamente en nuestro propio <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> debemos instalarlo previamente, como hacemos con <code class="docutils literal notranslate"><span class="pre">wget</span></code> a través de la sentencia <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span></code>.</p>
</section>
<section id="introduccion-ejemplo-brasil">
<h2>2.1 Introducción: ejemplo Brasil<a class="headerlink" href="#introduccion-ejemplo-brasil" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 72</strong></em></a></p>
<p>El siguiente código es introductorio y busca guiar al lector en la sintaxis básica a utilizar, mostrando a modo de ejemplo cómo replicar los resultados correspondientes al cuadro 2.1 del texto.</p>
<p>Como será al inicio de cada capítulo, el primer paso es obtener base de datos. Para esta sección, utilizaremos la versión procesada de la PNAD (Pesquisa Nacional por Amostra de Domicílios) de Brasil para el año 2007, a la cual accederemos desde la página del <a class="reference external" href="https://www.cedlas.econo.unlp.edu.ar/wp/en/publicaciones/libros/pobreza-y-desigualdad-en-america-latina/#1505501369949-15c93bca-b4f8"><em><strong>CEDLAS</strong></em></a>. Para acceder e importar la base se utiliza el procedimiento que se explica a continuación. Se crea una variable <em>url</em> que guarda el link donde se encuentra el archivo comprimido en formato <em>.zip</em>. Luego, se procede a descargar dicho archivo con la función <code class="docutils literal notranslate"><span class="pre">download()</span></code> de <code class="docutils literal notranslate"><span class="pre">wget</span></code>. Como el nombre del comprimido coincide con el archivo <em>.dta</em> que se encuentra contenido dentro, utilizamos la función <code class="docutils literal notranslate"><span class="pre">split()</span></code> que es estándar de <em>python</em> para guardar el nombre del archivo, sin la especificación del formato. Posteriormente, con la función <code class="docutils literal notranslate"><span class="pre">Zipfile()</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">zipfile</span></code> descomprimimos el <em>.zip</em> y nos quedamos solamente con el archivo <em>.dta</em>, ya que con <code class="docutils literal notranslate"><span class="pre">os.remove()</span></code> eliminamos el comprimido de nuestro directorio de trabajo, evaluando primero si el archivo existe con <code class="docutils literal notranslate"><span class="pre">os.path.exists()</span></code>. Pasado este punto, importamos la base con la función <code class="docutils literal notranslate"><span class="pre">read_stata</span></code> de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<p>Las encuestas de hogares, al igual que cualquier otra base de datos, se organizan en Python como objetos tipo tabla de doble entrada que reciben el nombre de <em>dataframe</em>, donde las filas representan observaciones o registros y las columnas variables o campos. Para poder ver visualizar el <em>dataframe</em> podemos utilizar dos alternativas (aunque existen otras, estas son las más comunes). Primero, podríamos leerlo en python solamente escribiendo el nombre de la base generada. La segunda opción sería utilizando <code class="docutils literal notranslate"><span class="pre">print()</span></code>. Por supuesto, las diferencias entre ambas formas es muy sutil, y en nuestro caso, no existirían diferencias entre usar una opción u otra. Para curiosos, pueden encontrar más info en <a class="reference external" href="https://stackoverflow.com/questions/8621000/in-python-idle-whats-the-difference-between-printing-a-variable-and-just-wri"><em><strong>stackoverflow</strong></em></a>. En nuestro caso, utilizamos la primera opción, que se puede ver cuando imprimimos <em>df</em> en la segunda línea que se ve a continuación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># descargamos el archivo zip </span>
<span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://www.cedlas.econo.unlp.edu.ar/wp/wp-content/uploads/bra07.zip&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">fileName</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># descomprimimos y eliminamos el archivo .zip</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
     <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="c1">## le damos estilo a la función print()</span>
<span class="c1"># Utilizamos algunos estilos </span>
<span class="k">class</span> <span class="nc">style</span><span class="p">():</span>
    <span class="n">black</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[30m&#39;</span>
    <span class="n">red</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[31m&#39;</span>
    <span class="n">green</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[1;32m&#39;</span> <span class="c1"># bold</span>
    <span class="n">underline</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[4m&#39;</span>
    <span class="n">mark</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\33</span><span class="s1">[44m&#39;</span>
    <span class="n">endc</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[0m&#39;</span>
<span class="c1"># si el comprimido existe en nuestro directorio lo eliminamos </span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;El archivo ha sido removido exitosamente&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;El archivo no existe!&quot;</span><span class="p">)</span>
<span class="c1"># cargamos el arcivho .dta</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.dta&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0% [                                                                          ]       0 / 2164747
  0% [                                                                          ]    8192 / 2164747
  0% [                                                                          ]   16384 / 2164747
  1% [                                                                          ]   24576 / 2164747
  1% [.                                                                         ]   32768 / 2164747
  1% [.                                                                         ]   40960 / 2164747
  2% [.                                                                         ]   49152 / 2164747
  2% [.                                                                         ]   57344 / 2164747
  3% [..                                                                        ]   65536 / 2164747
  3% [..                                                                        ]   73728 / 2164747
  3% [..                                                                        ]   81920 / 2164747
  4% [...                                                                       ]   90112 / 2164747
  4% [...                                                                       ]   98304 / 2164747
  4% [...                                                                       ]  106496 / 2164747
  5% [...                                                                       ]  114688 / 2164747
  5% [....                                                                      ]  122880 / 2164747
  6% [....                                                                      ]  131072 / 2164747
  6% [....                                                                      ]  139264 / 2164747
  6% [.....                                                                     ]  147456 / 2164747
  7% [.....                                                                     ]  155648 / 2164747
  7% [.....                                                                     ]  163840 / 2164747
  7% [.....                                                                     ]  172032 / 2164747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8% [......                                                                    ]  180224 / 2164747
  8% [......                                                                    ]  188416 / 2164747
  9% [......                                                                    ]  196608 / 2164747
  9% [.......                                                                   ]  204800 / 2164747
  9% [.......                                                                   ]  212992 / 2164747
 10% [.......                                                                   ]  221184 / 2164747
 10% [.......                                                                   ]  229376 / 2164747
 10% [........                                                                  ]  237568 / 2164747
 11% [........                                                                  ]  245760 / 2164747
 11% [........                                                                  ]  253952 / 2164747
 12% [........                                                                  ]  262144 / 2164747
 12% [.........                                                                 ]  270336 / 2164747
 12% [.........                                                                 ]  278528 / 2164747
 13% [.........                                                                 ]  286720 / 2164747
 13% [..........                                                                ]  294912 / 2164747
 14% [..........                                                                ]  303104 / 2164747
 14% [..........                                                                ]  311296 / 2164747
 14% [..........                                                                ]  319488 / 2164747
 15% [...........                                                               ]  327680 / 2164747
 15% [...........                                                               ]  335872 / 2164747
 15% [...........                                                               ]  344064 / 2164747
 16% [............                                                              ]  352256 / 2164747
 16% [............                                                              ]  360448 / 2164747
 17% [............                                                              ]  368640 / 2164747
 17% [............                                                              ]  376832 / 2164747
 17% [.............                                                             ]  385024 / 2164747
 18% [.............                                                             ]  393216 / 2164747
 18% [.............                                                             ]  401408 / 2164747
 18% [..............                                                            ]  409600 / 2164747
 19% [..............                                                            ]  417792 / 2164747
 19% [..............                                                            ]  425984 / 2164747
 20% [..............                                                            ]  434176 / 2164747
 20% [...............                                                           ]  442368 / 2164747
 20% [...............                                                           ]  450560 / 2164747
 21% [...............                                                           ]  458752 / 2164747
 21% [...............                                                           ]  466944 / 2164747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 21% [................                                                          ]  475136 / 2164747
 22% [................                                                          ]  483328 / 2164747
 22% [................                                                          ]  491520 / 2164747
 23% [.................                                                         ]  499712 / 2164747
 23% [.................                                                         ]  507904 / 2164747
 23% [.................                                                         ]  516096 / 2164747
 24% [.................                                                         ]  524288 / 2164747
 24% [..................                                                        ]  532480 / 2164747
 24% [..................                                                        ]  540672 / 2164747
 25% [..................                                                        ]  548864 / 2164747
 25% [...................                                                       ]  557056 / 2164747
 26% [...................                                                       ]  565248 / 2164747
 26% [...................                                                       ]  573440 / 2164747
 26% [...................                                                       ]  581632 / 2164747
 27% [....................                                                      ]  589824 / 2164747
 27% [....................                                                      ]  598016 / 2164747
 28% [....................                                                      ]  606208 / 2164747
 28% [.....................                                                     ]  614400 / 2164747
 28% [.....................                                                     ]  622592 / 2164747
 29% [.....................                                                     ]  630784 / 2164747
 29% [.....................                                                     ]  638976 / 2164747
 29% [......................                                                    ]  647168 / 2164747
 30% [......................                                                    ]  655360 / 2164747
 30% [......................                                                    ]  663552 / 2164747
 31% [......................                                                    ]  671744 / 2164747
 31% [.......................                                                   ]  679936 / 2164747
 31% [.......................                                                   ]  688128 / 2164747
 32% [.......................                                                   ]  696320 / 2164747
 32% [........................                                                  ]  704512 / 2164747
 32% [........................                                                  ]  712704 / 2164747
 33% [........................                                                  ]  720896 / 2164747
 33% [........................                                                  ]  729088 / 2164747
 34% [.........................                                                 ]  737280 / 2164747
 34% [.........................                                                 ]  745472 / 2164747
 34% [.........................                                                 ]  753664 / 2164747
 35% [..........................                                                ]  761856 / 2164747
 35% [..........................                                                ]  770048 / 2164747
 35% [..........................                                                ]  778240 / 2164747
 36% [..........................                                                ]  786432 / 2164747
 36% [...........................                                               ]  794624 / 2164747
 37% [...........................                                               ]  802816 / 2164747
 37% [...........................                                               ]  811008 / 2164747
 37% [............................                                              ]  819200 / 2164747
 38% [............................                                              ]  827392 / 2164747
 38% [............................                                              ]  835584 / 2164747
 38% [............................                                              ]  843776 / 2164747
 39% [.............................                                             ]  851968 / 2164747
 39% [.............................                                             ]  860160 / 2164747
 40% [.............................                                             ]  868352 / 2164747
 40% [.............................                                             ]  876544 / 2164747
 40% [..............................                                            ]  884736 / 2164747
 41% [..............................                                            ]  892928 / 2164747
 41% [..............................                                            ]  901120 / 2164747
 42% [...............................                                           ]  909312 / 2164747
 42% [...............................                                           ]  917504 / 2164747
 42% [...............................                                           ]  925696 / 2164747
 43% [...............................                                           ]  933888 / 2164747
 43% [................................                                          ]  942080 / 2164747
 43% [................................                                          ]  950272 / 2164747
 44% [................................                                          ]  958464 / 2164747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44% [.................................                                         ]  966656 / 2164747
 45% [.................................                                         ]  974848 / 2164747
 45% [.................................                                         ]  983040 / 2164747
 45% [.................................                                         ]  991232 / 2164747
 46% [..................................                                        ]  999424 / 2164747
 46% [..................................                                        ] 1007616 / 2164747
 46% [..................................                                        ] 1015808 / 2164747
 47% [...................................                                       ] 1024000 / 2164747
 47% [...................................                                       ] 1032192 / 2164747
 48% [...................................                                       ] 1040384 / 2164747
 48% [...................................                                       ] 1048576 / 2164747
 48% [....................................                                      ] 1056768 / 2164747
 49% [....................................                                      ] 1064960 / 2164747
 49% [....................................                                      ] 1073152 / 2164747
 49% [....................................                                      ] 1081344 / 2164747
 50% [.....................................                                     ] 1089536 / 2164747
 50% [.....................................                                     ] 1097728 / 2164747
 51% [.....................................                                     ] 1105920 / 2164747
 51% [......................................                                    ] 1114112 / 2164747
 51% [......................................                                    ] 1122304 / 2164747
 52% [......................................                                    ] 1130496 / 2164747
 52% [......................................                                    ] 1138688 / 2164747
 52% [.......................................                                   ] 1146880 / 2164747
 53% [.......................................                                   ] 1155072 / 2164747
 53% [.......................................                                   ] 1163264 / 2164747
 54% [........................................                                  ] 1171456 / 2164747
 54% [........................................                                  ] 1179648 / 2164747
 54% [........................................                                  ] 1187840 / 2164747
 55% [........................................                                  ] 1196032 / 2164747
 55% [.........................................                                 ] 1204224 / 2164747
 56% [.........................................                                 ] 1212416 / 2164747
 56% [.........................................                                 ] 1220608 / 2164747
 56% [..........................................                                ] 1228800 / 2164747
 57% [..........................................                                ] 1236992 / 2164747
 57% [..........................................                                ] 1245184 / 2164747
 57% [..........................................                                ] 1253376 / 2164747
 58% [...........................................                               ] 1261568 / 2164747
 58% [...........................................                               ] 1269760 / 2164747
 59% [...........................................                               ] 1277952 / 2164747
 59% [...........................................                               ] 1286144 / 2164747
 59% [............................................                              ] 1294336 / 2164747
 60% [............................................                              ] 1302528 / 2164747
 60% [............................................                              ] 1310720 / 2164747
 60% [.............................................                             ] 1318912 / 2164747
 61% [.............................................                             ] 1327104 / 2164747
 61% [.............................................                             ] 1335296 / 2164747
 62% [.............................................                             ] 1343488 / 2164747
 62% [..............................................                            ] 1351680 / 2164747
 62% [..............................................                            ] 1359872 / 2164747
 63% [..............................................                            ] 1368064 / 2164747
 63% [...............................................                           ] 1376256 / 2164747
 63% [...............................................                           ] 1384448 / 2164747
 64% [...............................................                           ] 1392640 / 2164747
 64% [...............................................                           ] 1400832 / 2164747
 65% [................................................                          ] 1409024 / 2164747
 65% [................................................                          ] 1417216 / 2164747
 65% [................................................                          ] 1425408 / 2164747
 66% [.................................................                         ] 1433600 / 2164747
 66% [.................................................                         ] 1441792 / 2164747
 66% [.................................................                         ] 1449984 / 2164747
 67% [.................................................                         ] 1458176 / 2164747
 67% [..................................................                        ] 1466368 / 2164747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 68% [..................................................                        ] 1474560 / 2164747
 68% [..................................................                        ] 1482752 / 2164747
 68% [..................................................                        ] 1490944 / 2164747
 69% [...................................................                       ] 1499136 / 2164747
 69% [...................................................                       ] 1507328 / 2164747
 70% [...................................................                       ] 1515520 / 2164747
 70% [....................................................                      ] 1523712 / 2164747
 70% [....................................................                      ] 1531904 / 2164747
 71% [....................................................                      ] 1540096 / 2164747
 71% [....................................................                      ] 1548288 / 2164747
 71% [.....................................................                     ] 1556480 / 2164747
 72% [.....................................................                     ] 1564672 / 2164747
 72% [.....................................................                     ] 1572864 / 2164747
 73% [......................................................                    ] 1581056 / 2164747
 73% [......................................................                    ] 1589248 / 2164747
 73% [......................................................                    ] 1597440 / 2164747
 74% [......................................................                    ] 1605632 / 2164747
 74% [.......................................................                   ] 1613824 / 2164747
 74% [.......................................................                   ] 1622016 / 2164747
 75% [.......................................................                   ] 1630208 / 2164747
 75% [........................................................                  ] 1638400 / 2164747
 76% [........................................................                  ] 1646592 / 2164747
 76% [........................................................                  ] 1654784 / 2164747
 76% [........................................................                  ] 1662976 / 2164747
 77% [.........................................................                 ] 1671168 / 2164747
 77% [.........................................................                 ] 1679360 / 2164747
 77% [.........................................................                 ] 1687552 / 2164747
 78% [.........................................................                 ] 1695744 / 2164747
 78% [..........................................................                ] 1703936 / 2164747
 79% [..........................................................                ] 1712128 / 2164747
 79% [..........................................................                ] 1720320 / 2164747
 79% [...........................................................               ] 1728512 / 2164747
 80% [...........................................................               ] 1736704 / 2164747
 80% [...........................................................               ] 1744896 / 2164747
 80% [...........................................................               ] 1753088 / 2164747
 81% [............................................................              ] 1761280 / 2164747
 81% [............................................................              ] 1769472 / 2164747
 82% [............................................................              ] 1777664 / 2164747
 82% [.............................................................             ] 1785856 / 2164747
 82% [.............................................................             ] 1794048 / 2164747
 83% [.............................................................             ] 1802240 / 2164747
 83% [.............................................................             ] 1810432 / 2164747
 84% [..............................................................            ] 1818624 / 2164747
 84% [..............................................................            ] 1826816 / 2164747
 84% [..............................................................            ] 1835008 / 2164747
 85% [...............................................................           ] 1843200 / 2164747
 85% [...............................................................           ] 1851392 / 2164747
 85% [...............................................................           ] 1859584 / 2164747
 86% [...............................................................           ] 1867776 / 2164747
 86% [................................................................          ] 1875968 / 2164747
 87% [................................................................          ] 1884160 / 2164747
 87% [................................................................          ] 1892352 / 2164747
 87% [................................................................          ] 1900544 / 2164747
 88% [.................................................................         ] 1908736 / 2164747
 88% [.................................................................         ] 1916928 / 2164747
 88% [.................................................................         ] 1925120 / 2164747
 89% [..................................................................        ] 1933312 / 2164747
 89% [..................................................................        ] 1941504 / 2164747
 90% [..................................................................        ] 1949696 / 2164747
 90% [..................................................................        ] 1957888 / 2164747
 90% [...................................................................       ] 1966080 / 2164747
 91% [...................................................................       ] 1974272 / 2164747
 91% [...................................................................       ] 1982464 / 2164747
 91% [....................................................................      ] 1990656 / 2164747
 92% [....................................................................      ] 1998848 / 2164747
 92% [....................................................................      ] 2007040 / 2164747
 93% [....................................................................      ] 2015232 / 2164747
 93% [.....................................................................     ] 2023424 / 2164747
 93% [.....................................................................     ] 2031616 / 2164747
 94% [.....................................................................     ] 2039808 / 2164747
 94% [......................................................................    ] 2048000 / 2164747
 94% [......................................................................    ] 2056192 / 2164747
 95% [......................................................................    ] 2064384 / 2164747
 95% [......................................................................    ] 2072576 / 2164747
 96% [.......................................................................   ] 2080768 / 2164747
 96% [.......................................................................   ] 2088960 / 2164747
 96% [.......................................................................   ] 2097152 / 2164747
 97% [.......................................................................   ] 2105344 / 2164747
 97% [........................................................................  ] 2113536 / 2164747
 98% [........................................................................  ] 2121728 / 2164747
 98% [........................................................................  ] 2129920 / 2164747
 98% [......................................................................... ] 2138112 / 2164747
 99% [......................................................................... ] 2146304 / 2164747
 99% [......................................................................... ] 2154496 / 2164747
 99% [......................................................................... ] 2162688 / 2164747
100% [..........................................................................] 2164747 / 2164747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">El archivo ha sido removido exitosamente</span>
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>edad</th>
      <th>pondera</th>
      <th>id</th>
      <th>hombre</th>
      <th>nivel</th>
      <th>region</th>
      <th>urbano</th>
      <th>ipcf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>73</td>
      <td>239</td>
      <td>14.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52</td>
      <td>238</td>
      <td>16.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>238</td>
      <td>16.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>34</td>
      <td>238</td>
      <td>34.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11</td>
      <td>238</td>
      <td>34.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>394546</th>
      <td>28</td>
      <td>180</td>
      <td>12621.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>0</td>
      <td>49591.71875</td>
    </tr>
    <tr>
      <th>394547</th>
      <td>0</td>
      <td>180</td>
      <td>12621.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>49591.71875</td>
    </tr>
    <tr>
      <th>394548</th>
      <td>8</td>
      <td>179</td>
      <td>12621.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>49591.71875</td>
    </tr>
    <tr>
      <th>394549</th>
      <td>60</td>
      <td>642</td>
      <td>72715.0</td>
      <td>1</td>
      <td>6.0</td>
      <td>3</td>
      <td>1</td>
      <td>66000.00000</td>
    </tr>
    <tr>
      <th>394550</th>
      <td>62</td>
      <td>643</td>
      <td>72715.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>3</td>
      <td>1</td>
      <td>66000.00000</td>
    </tr>
  </tbody>
</table>
<p>394551 rows × 8 columns</p>
</div></div></div>
</div>
<p>Al utilizar Stata resulta visualmente mejor imprimir los resultados con display asignando un color a este. Solemos utilizar <code class="docutils literal notranslate"><span class="pre">display</span> <span class="pre">as</span> <span class="pre">res</span> <span class="pre">|</span> <span class="pre">as</span> <span class="pre">err</span> <span class="pre">|</span> <span class="pre">as</span> <span class="pre">text</span></code>. Para <em>python</em> utilizamos una estrategia diferente, creamos una clase llamada <code class="docutils literal notranslate"><span class="pre">style()</span></code> que va a contener diferentes colores con la definición de color <a class="reference external" href="https://xdevs.com/guide/color_serial/"><em><strong>ANSI</strong></em></a>. Así, antes de escribir el texto en <code class="docutils literal notranslate"><span class="pre">print()</span></code> configuramos el color verde a la oración con <code class="docutils literal notranslate"><span class="pre">style.green</span></code>.</p>
<p>Por otra parte, cabe aclarar que las líneas que inician con numeral (<em>#</em>) son comentarios, es decir, se trata de líneas que en general documentan el código pero que Python ignora a la hora de computar los resultados.</p>
<p>Con la base de Brasil importada podemos indagar un poco más acerca de la composición del <em>dataframe</em> utilizando la función <code class="docutils literal notranslate"><span class="pre">info()</span></code> de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. El <em>output</em> que arroja la función muestra la cantidad de entradas u observaciones, la cantidad de columnas e información de cada variable que compone el <em>dataset</em>. Indicando nombre, cantidad de observaciones nulas y no nulas y el tipo de formato de la variable (numérica, <em>string¨</em> o booleana).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 394551 entries, 0 to 394550
Data columns (total 8 columns):
 #   Column   Non-Null Count   Dtype  
---  ------   --------------   -----  
 0   edad     394551 non-null  int16  
 1   pondera  394551 non-null  int16  
 2   id       394551 non-null  float32
 3   hombre   394551 non-null  int8   
 4   nivel    393101 non-null  float64
 5   region   394551 non-null  int8   
 6   urbano   394551 non-null  int8   
 7   ipcf     394551 non-null  float32
dtypes: float32(2), float64(1), int16(2), int8(3)
memory usage: 11.7 MB
</pre></div>
</div>
</div>
</div>
<p>Por tratarse de una encuesta, cada observación representa a varios individuos, tantos como indica el factor de expansión o variable de ponderación. En nuestro caso, todas las encuestas que utilizaremos contienen una variable de nombre <em>pondera</em> que almacena el factor de expansión. Para más detalles sobre el uso de ponderadores, consultar más adelante la sección 3.6.</p>
<p>El primer paso es extraer las variables de interés del dataframe <em>df</em>. En nuestro caso, utilizamos las variables <em>ipcf</em> y el factor de expansión <em>pondera</em>. Con estos inputs podemos calcular la media y desvío estándar del ingreso per cápita familiar a partir de la función <code class="docutils literal notranslate"><span class="pre">average()</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">numpy</span></code> y <code class="docutils literal notranslate"><span class="pre">sqrt()</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">math</span></code>.</p>
<p>A su vez, podríamos querer saber cuánta gente está representada por la encuesta, para ello podríamos sumar la cantidad de observaciones considerando el factor de expansión de cada observación. Para esto último, usamos la función <code class="docutils literal notranslate"><span class="pre">sum()</span></code> que viene incluído en <em>python</em> sobre la variable <em>pondera</em>. La población de referencia de la PNAD 2007 es 187 millones de personas aproximadamente. Por último, podemos computar el coeficiente de variación del <em>ipcf</em> una vez calculado su desvío estándar y su media. Para visualizar los resultados utilizamos la función estándar <code class="docutils literal notranslate"><span class="pre">print()</span></code> con el argumento ‘<em>f</em> ‘ que significa <a class="reference external" href="https://docs.python.org/3.6/reference/lexical_analysis.html#formatted-string-literals"><em>Formatted string literals</em></a>, lo cual básicamente hace que las sentencias dentro de las llaves <code class="docutils literal notranslate"><span class="pre">{}</span></code> sean reemplazados por los valores de la respectiva variable, si es que existen. Un argumento muy útil para darle formato a las <em>string</em> (como en la visualización del cálculo de la población de Brasil) y cómodo para visualizar resultados combinados con texto, inclusive el recurso <code class="docutils literal notranslate"><span class="pre">\n</span></code> permite separar los diferentes <em>prints</em>, permitiendo mayor prolijidad en la impresión de resultados (Más info en <a class="reference external" href="https://tutorial.eyehunts.com/python/printf-python-python-f-print-example-code/#:~:text=Print(f%20Python)%3A%20The,is%20more%20readable%20and%20fast."><em>print(f”…”)</em></a>). A su vez, se redondean los resultados con la función estándar de python <code class="docutils literal notranslate"><span class="pre">round()</span></code>. En el caso del redondeo del coeficiente de variación <em>cv</em> se agrega un segundo argumento que representa la cantidad de decimales a mostrar (2 en este caso), ya que por defecto al función no mostraría ninguno. También, le damos formato al resultado de la población de Brasil, especificando cómo debe formarse el número con <code class="docutils literal notranslate"><span class="pre">{:,}.format()</span></code>, que lo que le dice a <code class="docutils literal notranslate"><span class="pre">print()</span></code> es que separe los miles con comas <code class="docutils literal notranslate"><span class="pre">,</span></code> a la variable <em>pop</em> para imprimirlo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extraemos las columnas del IPCF y los ponderadores y las convertimos en vectores</span>
<span class="n">ipcf</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span>
<span class="n">pondera</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span>

<span class="c1"># Utilizamos esos vectores para calcular el promedio y la varianza del IPCF</span>
<span class="n">media</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">ipcf</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">pondera</span><span class="p">)</span> 
<span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">((</span><span class="n">ipcf</span><span class="o">-</span><span class="n">media</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">pondera</span><span class="p">)</span> 
<span class="n">de</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

<span class="c1"># Calculamos la poblacion total de referencia</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pondera</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Calculamos el coeficiente de variacion</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">de</span><span class="o">/</span><span class="n">media</span>

<span class="c1"># visualizamos resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;Media del IPCF = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">media</span><span class="p">)</span><span class="si">}</span><span class="s1">; Desvío estándar del IPCF = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">de</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;Población de referencia Brasil = </span><span class="si">{</span><span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;Coeficiente de variacion del IPCF = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Media del IPCF = 574; Desvío estándar del IPCF = 970</span>

<span class=" -Color -Color-Bold -Color-Bold-Green">Población de referencia Brasil = 186,985,040</span>

<span class=" -Color -Color-Bold -Color-Bold-Green">Coeficiente de variacion del IPCF = 1.69</span>
</pre></div>
</div>
</div>
</div>
<p>Si por ejemplo, calculáramos la media del <em>ipcf</em> sin ponderar obtendríamos <strong>559</strong>, lo cual es diferente del valor ponderado.</p>
<p>También, podríamos replicar el ejercicio con un subconjunto del dataframe, como una región por ejemplo. La diferencia entre el cálculo por regiones y de todo el dataframe se encuentra en la forma en que se establece las filas que voy a utilizar. En el caso de las regiones, le indico a <em>python</em> que tome solamente los valores cuya region está codificada con el valor 2 para crear las variables <em>ipcf</em> y <em>pondera</em>, algo que no se indicó al utilizar toda la base. Por otra parte, cabe remarcar la ventaja que presenta <em>python</em> en términos de flexibilidad. Para seleccionar una variable dentro de un dataframe se pueden utilizar dos métodos a partir del nombre, escribir entre corchetes <code class="docutils literal notranslate"><span class="pre">[]</span></code> con comillas <code class="docutils literal notranslate"><span class="pre">''</span></code> o hacerlo después de un punto <code class="docutils literal notranslate"><span class="pre">.</span></code> como se realiza con el <em>ipcf</em> para la región Nordeste. A su vez, el orden es indiferente para <em>python</em>, en la región Nordeste la columna a seleccionar se encuentra después del pedido para seleccionar las filas que voy a utilizar, mientras que en el caso de la región Norte la misma se encuentra antes. A su vez, si quisieramos hacer el procedimiento más directo podríamos evitar crear una variable adicional y poner la sentencia de selección de variables y filas directamente en el cálculo del estadístico. Por ejemplo, en el caso de <em>media_1</em> podríamos generarlo de la siguiente manera:</p>
<p><code class="docutils literal notranslate"><span class="pre">media_1</span> <span class="pre">=</span> <span class="pre">np.average(df.ipcf[df['region']==1],</span> <span class="pre">weights=df[&quot;pondera&quot;][df['region']==1])</span></code></p>
<p>Si bien la opción directa pareciera ser más desprolija o menos ordenada, podríamos encontrarnos en análisis descriptivos con bases de datos considerablemente grandes que requieren mucho espacio, por lo que generar nuevas variables o bases en paralelo no sería la mejor opción. En estos casos, necesitaríamos ganar eficiencia más que prolijidad. Por lo que tener en cuenta este recurso que permite <em>python</em> nos podría facilitar el ejercicio al encontrarnos en contextos de grandes <em>datasets</em>. Si bie en la mayoría de los casos generaremos las variables primero, separando del <em>dataframe</em>, trataremos de no crear bases de datos en paralelo, siempre que podamos evitarlo. Por otra parte, <code class="docutils literal notranslate"><span class="pre">print()</span></code> también se utiliza de una manera alternativa, separando los elementos (string y variables) con comas <code class="docutils literal notranslate"><span class="pre">,</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replicamos los calculos para la region Nordeste</span>

<span class="c1"># Extraemos las columnas del IPCF y los ponderadores y las convertimos en vectores</span>
<span class="n">ipcf_2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">ipcf</span>
<span class="n">pondera_2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span>

<span class="c1"># Utilizamos estos vectores para calcular las estadísticas descriptivas</span>
<span class="n">media_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">ipcf_2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">pondera_2</span><span class="p">)</span>  
<span class="n">var_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">((</span><span class="n">ipcf_2</span><span class="o">-</span><span class="n">media_2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">pondera_2</span><span class="p">)</span> 
<span class="n">de_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_2</span><span class="p">)</span>
<span class="n">cv_2</span> <span class="o">=</span> <span class="n">de_2</span><span class="o">/</span><span class="n">media_2</span>
<span class="n">pop_2</span> <span class="o">=</span> <span class="n">pondera_2</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Visualizamos</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Media del IPCF en Nordeste =&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">media_2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Desvío estándar del IPCF en Nordeste =&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">de_2</span><span class="p">))</span>       
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Coeficiente de variación del IPCF en Nordeste =&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">cv_2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Población de referencia en Nordeste =&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Media del IPCF en Nordeste = 345</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Desvío estándar del IPCF en Nordeste = 656</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Coeficiente de variación del IPCF en Nordeste = 1.9</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Población de referencia en Nordeste = 51,749,343</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replicamos los calculos para la region Norte</span>

<span class="c1"># Extraemos las columnas del IPCF y los ponderadores y las convertimos en vectores</span>
<span class="n">ipcf_1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ipcf</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pondera_1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Utilizamos estos vectores para calcular las estadisticas descriptivas</span>
<span class="n">media_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">ipcf_1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">pondera_1</span><span class="p">)</span>  
<span class="n">var_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">((</span><span class="n">ipcf_1</span><span class="o">-</span><span class="n">media_1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">pondera_1</span><span class="p">)</span> 
<span class="n">de_1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var_1</span><span class="p">)</span>
<span class="n">cv_1</span> <span class="o">=</span> <span class="n">de_1</span><span class="o">/</span><span class="n">media_1</span>
<span class="n">pop_1</span> <span class="o">=</span> <span class="n">pondera_1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Visualizamos</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Media del IPCF en Norte =&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">media_1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Desvio estandar del IPCF en Norte =&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">de_1</span><span class="p">))</span>       
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Coeficiente de variacion del IPCF en Norte =&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">cv_1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Poblacion de referencia en Norte =&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Media del IPCF en Norte = 391</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Desvio estandar del IPCF en Norte = 754</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Coeficiente de variacion del IPCF en Norte = 1.93</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Poblacion de referencia en Norte = 15,232,858</span>
</pre></div>
</div>
</div>
</div>
<p>Por último, quizás sea útil tener alguna forma de resumir diferentes estadísticos a partir de una sola función. Para <em>python</em>, podríamos pensar en <code class="docutils literal notranslate"><span class="pre">describe()</span></code>, una función de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. Lo ejecutamos fácilmente de la siguiente manera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipcf</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    394551.000000
mean        559.112244
std         990.200439
min           0.000000
25%         157.519989
50%         310.000000
75%         590.000000
max       66000.000000
Name: ipcf, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Como se puede ver, <code class="docutils literal notranslate"><span class="pre">describe()</span></code> resume el ingreso per cápita familiar computando estadísticos como la frecuencia absoluta, el promedio, desvío estándar, valor mínimo y máximo del vector, entre otros. Sin embargo, la misma no tiene en cuenta el factor de expansión, que no se encuentra disponible entre los argumentos que permite <code class="docutils literal notranslate"><span class="pre">describe()</span></code>. De hecho, el promedio es <strong>559</strong>, valor que anticipábamos como resultado del <em>ipcf</em> sin ponderar. A su vez, podríamos querer agregar o sacar estadísticos específicos que se ajusten a nuestro problema, como el <em>coeficiente de variación</em> visto antes, por ejemplo. Una opción recomendada para usuarios más familiarizados con la sintaxis de <em>python</em> podría ser la de crear su propia función. Como dicen por ahí: ‘<em>cuando escribís el mismo código tres veces, armá una función</em>’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">descriptive_stats</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ponderador</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot; función para replicar describe() de pandas pero con ponderador </span>
<span class="sd">    :param x: serie de interés</span>
<span class="sd">    :param ponderador: serie a usar como ponderador</span>
<span class="sd">    :return: serie de pandas con los resultados </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># chequeo de error fatal </span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Falta asignar variable a x&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ponderador</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Falta asignar variable a ponderador&#39;</span><span class="p">)</span>
    <span class="c1"># promedio</span>
    <span class="n">media</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">ponderador</span><span class="p">)</span>  
    <span class="c1"># mínimo y máximo</span>
    <span class="n">xmin</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="c1"># varianza</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">media</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">ponderador</span><span class="p">)</span> 
    <span class="c1"># desvío estándar</span>
    <span class="n">de</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="c1"># coeficiente de variación</span>
    <span class="n">cv</span> <span class="o">=</span> <span class="n">de</span><span class="o">/</span><span class="n">media</span>
    <span class="c1"># población sin y con ponderación</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">pop_ponderado</span> <span class="o">=</span> <span class="n">ponderador</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="c1"># cuartiles</span>
    <span class="n">index_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">index_sorted</span><span class="p">]</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="n">ponderador</span><span class="p">[</span><span class="n">index_sorted</span><span class="p">]</span>
    <span class="n">quartile_ponderado</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">freqs</span>
    <span class="n">quartile_ponderado</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span>
    <span class="n">q25</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">quartile_ponderado</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
    <span class="n">q50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">quartile_ponderado</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
    <span class="n">q75</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">quartile_ponderado</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>    
    <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;count_w&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">,</span> <span class="s1">&#39;50%&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;cv&#39;</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop_ponderado</span><span class="p">),</span> 
                        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">media</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">de</span><span class="p">),</span> 
                        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xmin</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q25</span><span class="p">),</span> 
                        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q50</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q75</span><span class="p">),</span> 
                        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xmax</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cv</span><span class="p">)],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>Una función se compone del argumento <code class="docutils literal notranslate"><span class="pre">def</span></code>, el nombre que le vamos a dar (<code class="docutils literal notranslate"><span class="pre">descriptive_stats()</span></code> en nuestro caso) y los argumentos que le vamos asignar. En nuestra función, <em>x</em> representa la serie que nos interesa resumir; <em>ponderador</em> el factor de expansión a utilizar. Estos últimos entre paréntesis <code class="docutils literal notranslate"><span class="pre">()</span></code> y se finaliza la sentencia con dos puntos <code class="docutils literal notranslate"><span class="pre">:</span></code>. Dentro de la función tenemos dos bloques de códigos que deberíamos indicar. En primer lugar, aunque opcional, las cadenas de documentación o <em>docstrings</em> donde se describe para qué sirven los argumentos dentro de la función y cómo se utilizan, lo cual se encuentra delimitado por triples comillas <code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;...&quot;&quot;&quot;</span></code>. En segundo lugar, el bloque de códigos para ejecutar, que puede tener incluído o no una sentencia de retorno (como sí ocurre en nuestro caso en <code class="docutils literal notranslate"><span class="pre">return</span></code>), y comienza con las sentencias de evaluación de “errores fatales”, que permiten determinar antes que nada si utilizamos la función correctamente. En nuestro caso, si incluimos ambos argumentos que requiere la misma para ejecutarse. En caso de no hacerlo la función nos indicará que no lo estamos haciendo y detendrá la ejecución de la función sin haber realizado calculo alguno. Para más información sobre funciones puede consultarse <a class="reference external" href="https://j2logo.com/python/tutorial/funciones-en-python/"><em><strong>J2LOGO</strong></em></a>, <a class="reference external" href="https://www.freecodecamp.org/espanol/news/guia-de-funciones-de-python-con-ejemplos/#:~:text=Las%20funciones%20en%20Python%20se,funci%C3%B3n%20siempre%20devuelve%20un%20valor."><em><strong>freeCodeCamp</strong></em></a> o <a class="reference external" href="https://entrenamiento-python-basico.readthedocs.io/es/latest/leccion5/funciones.html"><em><strong>COVANTEC</strong></em></a>.</p>
<p>En cuanto al bloque de códigos ‘nada nuevo bajo el sol’. Se utilizan las mismas funciones que veníamos usando, con la diferencia de que al reemplazar <em>ipcf</em> por la variable genérica <em>x</em> y <em>pondera</em> por <em>ponderador</em> convertimos la serie de códigos de antes en una rutina reutilizable para otras variables numéricas diferentes a <em>ipcf</em> que quizás utilicen otra variable como factor de expansión. Solamente dos cosas a tener en cuenta. Primero, para la población total sin ponderación se toman únicamente los valores no nulos con la función <code class="docutils literal notranslate"><span class="pre">notna()</span></code> de pandas. Por otra parte, la generación de los cuartiles ponderados. Para el desarrollo del mismo se sigue el procedimiento <a class="reference external" href="https://en.wikipedia.org/wiki/Percentile#Definition_of_the_Weighted_Percentile_method"><em><strong>weighted percentile method</strong></em></a>.</p>
<p>Una vez establecido los cálculos necesarios, creamos un índice <em>idx</em> que contiene los nombres que le vamos a asignar a los estadísticos que guardamos en la serie <em>result</em> donde guardamos todos los valores, configurando previamente el formato de los mismos. Finalizando con el argumento <code class="docutils literal notranslate"><span class="pre">return</span></code>, para que la función devuelva nuestro output con los resultados, ya tenemos nuestra primera función <em>custom</em>. A continuación, pasamos a implementarla con las variables <em>ipcf</em> y <em>pondera</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">descriptive_stats</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ipcf</span><span class="p">,</span> <span class="n">ponderador</span><span class="o">=</span><span class="n">pondera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count          394,551
count_w    186,985,040
mean            574.35
std             970.24
min               0.00
25%             165.00
50%             330.00
75%             621.50
max           66000.00
cv                1.69
Name: ipcf, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Finalizamos el apartado de ejemplo para Brasil con el cálculo de pobreza para el año 2007, utilizando una línea de pobreza de 130 reales mensuales y añadimos la variable <em>pobreza</em> a la base, que es una <em>dummy</em> que indica con valor 1 si la persona tiene un <em>ipcf</em> inferior a esa linea y 0 en caso contrario. Luego, calculamos la proporción de pobres a través del promedio de <em>pobreza</em>. Con esa proporción podemos saber cuántas personas eran pobres en Brasil en el 2007, recuperando el cálculo de la población total <em>pop</em> que se hizo antes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Establecemos una linea de pobreza e identificamos personas que caen dentro</span>
<span class="n">linea_pobreza</span> <span class="o">=</span> <span class="mf">129.883</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;pobreza&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">linea_pobreza</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>

<span class="c1"># Calculamos la tasa de pobreza como el promedio de la variable creada</span>
<span class="n">tasa_pobreza</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pobreza&quot;</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">pondera</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Tasa de pobreza =&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:.0%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tasa_pobreza</span><span class="p">))</span>

<span class="c1"># Calculamos el total de individuos pobres como el producto entre la tasa de pobreza y la poblacion total</span>
<span class="n">pop_pob</span> <span class="o">=</span> <span class="n">tasa_pobreza</span><span class="o">*</span><span class="n">pop</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span>  <span class="s2">&quot;Poblacion pobre =&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:,.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop_pob</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Tasa de pobreza = 18%</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Poblacion pobre = 33,999,787</span>
</pre></div>
</div>
</div>
</div>
<p>Como se puede observar en los resultados, el 18% de la población brasilera era pobre en 2007, un total de 34 millones de personas aproximadamente. A continuación, podemos repetir el ejercicio para alguna región específica, como el Norte de Brasil.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Región Norte</span>
<span class="c1"># Filtramos la region de interés</span>
<span class="n">pob_1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pobreza&quot;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># Repetimos el procedimiento anterior</span>
<span class="n">tasa_pobreza_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">pob_1</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">pondera_1</span><span class="p">)</span>
<span class="n">pop_pob_1</span> <span class="o">=</span> <span class="n">tasa_pobreza_1</span><span class="o">*</span><span class="n">pop_1</span> <span class="c1"># pop_1 ya lo teníamos calculado</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;Tasa de pobreza en Norte = </span><span class="si">{</span><span class="s2">&quot;</span><span class="si">{:.0%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tasa_pobreza_1</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">pop_pob_1</span> <span class="o">=</span> <span class="n">tasa_pobreza_1</span><span class="o">*</span><span class="n">pop_1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;Poblacion pobre en Norte =&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{:,.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop_pob_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Tasa de pobreza en Norte = 26%</span>

<span class=" -Color -Color-Bold -Color-Bold-Green">Poblacion pobre en Norte = 4,011,298</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="histogramas">
<h2>2.2 Histogramas<a class="headerlink" href="#histogramas" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 72</strong></em></a></p>
<p>Siguiendo el apéndice del libro mostramos cómo generar una serie de visualizaciones que nos ayudarán a analizar la distribución de una variable. Para ello, utilizaremos las librerías <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> y <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>. Principalmente las últimas dos librerías, que nos van a permitir crear gráficos. En primer lugar, mostramos cómo puede graficarse un histograma de la distribución del <em>ipcf</em> para México. Para ello, importamos la versión procesada de la Encuesta Nacional de Ingresos y Gastos de los Hogares (ENIGH) de México para el año 2006 disponible en la página de CEDLAS. La misma cuenta tanto con el ingreso per cápita familiar como con el factor de expansión, denominado también <em>pondera</em>. Ambas variables serán utilizadas en lo que resta de este apéndice.</p>
<p>Dicho esto, importamos la ENIGH para México 2006 de la misma manera que importamos la base PNAD de Brasil.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># descargamos el archivo zip </span>
<span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://www.cedlas.econo.unlp.edu.ar/wp/wp-content/uploads/mex06.zip&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">fileName</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># descomprimimos y eliminamos el archivo .zip</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
     <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="c1"># si el comprimido existe en nuestro directorio lo eliminamos </span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;El archivo ha sido removido exitosamente&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="s2">&quot;El archivo no existe!&quot;</span><span class="p">)</span>
<span class="c1"># cargamos el arcivho .dta</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.dta&#39;</span><span class="p">)</span> 
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0% [                                                                            ]      0 / 419160
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1% [.                                                                           ]   8192 / 419160
  3% [..                                                                          ]  16384 / 419160
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5% [....                                                                        ]  24576 / 419160
  7% [.....                                                                       ]  32768 / 419160
  9% [.......                                                                     ]  40960 / 419160
 11% [........                                                                    ]  49152 / 419160
 13% [..........                                                                  ]  57344 / 419160
 15% [...........                                                                 ]  65536 / 419160
 17% [.............                                                               ]  73728 / 419160
 19% [..............                                                              ]  81920 / 419160
 21% [................                                                            ]  90112 / 419160
 23% [.................                                                           ]  98304 / 419160
 25% [...................                                                         ] 106496 / 419160
 27% [....................                                                        ] 114688 / 419160
 29% [......................                                                      ] 122880 / 419160
 31% [.......................                                                     ] 131072 / 419160
 33% [.........................                                                   ] 139264 / 419160
 35% [..........................                                                  ] 147456 / 419160
 37% [............................                                                ] 155648 / 419160
 39% [.............................                                               ] 163840 / 419160
 41% [...............................                                             ] 172032 / 419160
 42% [................................                                            ] 180224 / 419160
 44% [..................................                                          ] 188416 / 419160
 46% [...................................                                         ] 196608 / 419160
 48% [.....................................                                       ] 204800 / 419160
 50% [......................................                                      ] 212992 / 419160
 52% [........................................                                    ] 221184 / 419160
 54% [.........................................                                   ] 229376 / 419160
 56% [...........................................                                 ] 237568 / 419160
 58% [............................................                                ] 245760 / 419160
 60% [..............................................                              ] 253952 / 419160
 62% [...............................................                             ] 262144 / 419160
 64% [.................................................                           ] 270336 / 419160
 66% [..................................................                          ] 278528 / 419160
 68% [...................................................                         ] 286720 / 419160
 70% [.....................................................                       ] 294912 / 419160
 72% [......................................................                      ] 303104 / 419160
 74% [........................................................                    ] 311296 / 419160
 76% [.........................................................                   ] 319488 / 419160
 78% [...........................................................                 ] 327680 / 419160
 80% [............................................................                ] 335872 / 419160
 82% [..............................................................              ] 344064 / 419160
 84% [...............................................................             ] 352256 / 419160
 85% [.................................................................           ] 360448 / 419160
 87% [..................................................................          ] 368640 / 419160
 89% [....................................................................        ] 376832 / 419160
 91% [.....................................................................       ] 385024 / 419160
 93% [.......................................................................     ] 393216 / 419160
 95% [........................................................................    ] 401408 / 419160
 97% [..........................................................................  ] 409600 / 419160
 99% [........................................................................... ] 417792 / 419160
100% [............................................................................] 419160 / 419160<span class=" -Color -Color-Bold -Color-Bold-Green">El archivo ha sido removido exitosamente</span>
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>edad</th>
      <th>id</th>
      <th>pondera</th>
      <th>hombre</th>
      <th>region</th>
      <th>urbano</th>
      <th>nivel</th>
      <th>ipcf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>97</td>
      <td>38</td>
      <td>1098</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>23</td>
      <td>108</td>
      <td>98</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>2.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>108</td>
      <td>98</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>3.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>72</td>
      <td>161</td>
      <td>638</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>90</td>
      <td>161</td>
      <td>638</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>81999</th>
      <td>17</td>
      <td>16587</td>
      <td>607</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3.0</td>
      <td>109714.742188</td>
    </tr>
    <tr>
      <th>82000</th>
      <td>65</td>
      <td>15205</td>
      <td>1159</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>6.0</td>
      <td>144282.562500</td>
    </tr>
    <tr>
      <th>82001</th>
      <td>61</td>
      <td>15205</td>
      <td>1159</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>3.0</td>
      <td>144282.562500</td>
    </tr>
    <tr>
      <th>82002</th>
      <td>34</td>
      <td>11028</td>
      <td>2098</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>6.0</td>
      <td>165842.015625</td>
    </tr>
    <tr>
      <th>82003</th>
      <td>48</td>
      <td>8710</td>
      <td>798</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>6.0</td>
      <td>192500.000000</td>
    </tr>
  </tbody>
</table>
<p>82004 rows × 8 columns</p>
</div></div></div>
</div>
<p>Antes de comenzar a graficar, podríamos tener el interés de elegir un estilo visual para todos los gráficos. Para esto, recurrimos a la librería <code class="docutils literal notranslate"><span class="pre">style</span></code> de <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Solarize_Light2&#39;, &#39;_classic_test_patch&#39;, &#39;_mpl-gallery&#39;, &#39;_mpl-gallery-nogrid&#39;, &#39;bmh&#39;, &#39;classic&#39;, &#39;dark_background&#39;, &#39;fast&#39;, &#39;fivethirtyeight&#39;, &#39;ggplot&#39;, &#39;grayscale&#39;, &#39;seaborn&#39;, &#39;seaborn-bright&#39;, &#39;seaborn-colorblind&#39;, &#39;seaborn-dark&#39;, &#39;seaborn-dark-palette&#39;, &#39;seaborn-darkgrid&#39;, &#39;seaborn-deep&#39;, &#39;seaborn-muted&#39;, &#39;seaborn-notebook&#39;, &#39;seaborn-paper&#39;, &#39;seaborn-pastel&#39;, &#39;seaborn-poster&#39;, &#39;seaborn-talk&#39;, &#39;seaborn-ticks&#39;, &#39;seaborn-white&#39;, &#39;seaborn-whitegrid&#39;, &#39;tableau-colorblind10&#39;]
</pre></div>
</div>
</div>
</div>
<p>A partir del print podemos ver todos los estilos disponibles para graficar. En mi caso, por afecto que tengo al software <strong>R</strong>, para este capítulo vamos a utilizar el estilo <code class="docutils literal notranslate"><span class="pre">ggplot</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En primer lugar, vamos a graficar histogramas presentados en el libro (figuras 2.2 a 2.8 del desarrollo), y para hacerlo primero separamos las columnas que vamos a utilizar como <em>inputs</em>, es decir, <em>ipcf</em> y <em>pondera</em> de la misma manera que antes, aunque esta vez consideramos valores no nulos y que no sean faltantes.</p>
<p>En primer lugar, extraemos las columnas <em>ipcf</em> y <em>pondera</em>. Para graficar datos que le den sentido al análisis nos quedamos con los ingresos no nulos y no faltantes. Por lo que a la selección de ambas variables le pedimos que tome las observaciones que cumplan esa condición.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># contruimos vectores</span>
<span class="n">ipcf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="s1">&#39;ipcf&#39;</span><span class="p">)]</span>
<span class="n">pondera</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="s1">&#39;ipcf&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Para graficar se sigue convencionalmente el siguiente procedimiento. Primero, se genera el box donde se va a “dibujar” el <em>plot</em> a través de la sentencia <code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots()</span></code>. <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> es una función que retorna una lista que contiene una figura y objetos para los ejes, por lo que al escribir <code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots()</span></code> lo que estamos haciendo es obtener este kit en las variables <code class="docutils literal notranslate"><span class="pre">fig</span></code> y <code class="docutils literal notranslate"><span class="pre">ax</span></code> y graficarlos. En esencia, <code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">ax</span> <span class="pre">=</span>&#160; <span class="pre">plt.subplots()</span></code> resulta un atajo para la sentencia</p>
<p><code class="docutils literal notranslate"><span class="pre">fig</span> <span class="pre">=</span> <span class="pre">plt.figure()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">ax</span> <span class="pre">=</span> <span class="pre">fig.add_subplot()</span></code></p>
<p>Para entender la idea pueden intentar ejecutando solamente la sentencia <code class="docutils literal notranslate"><span class="pre">fig,</span> <span class="pre">ax</span> <span class="pre">=</span> <span class="pre">plt.subplots(figsize=(12,</span> <span class="pre">10)</span></code> y ver qué pasa. Aquellos que tengan mayor curiosidad acerca de esto pueden visitar <a class="reference external" href="https://matplotlib.org/3.2.2/api/_as_gen/matplotlib.pyplot.subplots.html"><em><strong>matplotlib</strong></em></a>, <a class="reference external" href="https://nbviewer.org/github/matplotlib/AnatomyOfMatplotlib/blob/master/AnatomyOfMatplotlib-Part1-Figures_Subplots_and_layouts.ipynb"><em><strong>Jupyter Notebook Viewer</strong></em></a> y <a class="reference external" href="https://stackoverflow.com/questions/34162443/why-do-many-examples-use-fig-ax-plt-subplots-in-matplotlib-pyplot-python"><em><strong>stackoverflow</strong></em></a>.</p>
<p>Posteriormente, utilizamos el box ya creado para armar el histograma dentro con la función <code class="docutils literal notranslate"><span class="pre">ax.hist()</span></code> de la variable <em>ipcf</em> considerando el factor de expansión <em>pondera</em> con 100 intervalos o <em>bins</em>. Los demás argumentos son seteos para darle formato, y pueden consultarse en <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.hist.html"><em><strong>matplotlib</strong></em></a>. A su vez, las labels que aparecen a continuación en el código también se puede encontrar en el mismo link, escribiendo en su buscador ‘<em>matplotlib.pyplot.title</em>’, ‘<em>matplotlib.pyplot.ylabel</em>’ y ‘<em>matplotlib.pyplot.xlabel</em>’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.2 - histograma ipcf</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ipcf</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> 
        <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;proporción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Ingreso per cápita familiar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histograma IPCF-Mexico-2006&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_33_0.png" src="../_images/capitulo2_33_0.png" />
</div>
</div>
<p>Con las líneas siguientes se filtra la base para individuos con <em>ipcf</em> menor a 15000 para evitar la típica distorsión generada por los valores extremos. Para realizar este filtro podríamos hacer algo similar al filtro que hicimos con las regiones de Brasil. Podríamos crear una variable nueva llamada <code class="docutils literal notranslate"><span class="pre">ipcf_temp</span></code> donde, a la condición de valores no nulos y no missings, le agregamos el requisito adicional de que el <em>ipcf</em> sea menor a 15000. Podríamos pensar en dos formas alternativas de hacer esto</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ipcf_temp</span> <span class="pre">=</span> <span class="pre">df.ipcf[(df['ipcf']</span> <span class="pre">!=</span> <span class="pre">0)</span> <span class="pre">&amp;</span> <span class="pre">(pd.notna('ipcf'))</span> <span class="pre">&amp;</span> <span class="pre">(df['ipcf']</span> <span class="pre">&lt;</span> <span class="pre">15000)]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ipcf_temp</span> <span class="pre">=</span> <span class="pre">df.loc[(df['ipcf']</span> <span class="pre">!=</span> <span class="pre">0)</span> <span class="pre">&amp;</span> <span class="pre">(pd.notna('ipcf'))</span> <span class="pre">&amp;</span> <span class="pre">(df['ipcf']</span> <span class="pre">&lt;</span> <span class="pre">15000),</span> <span class="pre">&quot;ipcf&quot;]</span></code></p></li>
</ul>
<p>La primera es similar a lo que veníamos implementando para filtar observaciones y quedarnos con una sola variable, mientras que la segunda podrá serles más familiar a usuarios de <em>R</em>, debido a que, a través de la función <code class="docutils literal notranslate"><span class="pre">loc()</span></code> de <code class="docutils literal notranslate"><span class="pre">pandas</span></code> le pedimos a <em>python</em> que tome las filas que cumplan las condiciones estipuladas a la izquierda de la coma <code class="docutils literal notranslate"><span class="pre">,</span></code> pero que solamente seleccione la columna <em>ipcf</em>, lo cual se indica en el segundo elemento a la derecha. Cualquiera de las opciones es recomendada, más cuando se pretende hacer un filtro de múltiples columnas. Para este simple ejercicio, como ya hemos extraído previamente <em>ipcf</em> del <em>dataframe</em>, optaremos por una tercera vía. En primer lugar, reutilizamos la variable <em>ipcf</em> (que cumple con las condiciones de valores no nulos y no <em>missings</em>) y le aplicamos el filtro de interés. Debido a que trabajaremos sobre las series ya separadas del dataframe lo que hacemos para <em>pondera</em> es filtrar la base con las filas que quedaron en <em>ipcf</em>, a partir del argumento <code class="docutils literal notranslate"><span class="pre">index</span></code>. Por supuesto, quedará en manos del lector probar los filtros explicados previamente para ver que cualquier camino conduce al mismo resultado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtro</span>
<span class="n">ipcf_temp</span> <span class="o">=</span> <span class="n">ipcf</span><span class="p">[</span><span class="n">ipcf</span> <span class="o">&lt;</span> <span class="mi">15000</span><span class="p">]</span>
<span class="n">pondera_temp</span> <span class="o">=</span> <span class="n">pondera</span><span class="p">[</span><span class="n">ipcf_temp</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="c1"># Figura 2.3 - histograma ipcf sin outliers</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ipcf_temp</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pondera_temp</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">pondera_temp</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Ingreso per cápita familiar&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Proporción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histograma IPCF-Mexico-2006 (excluye IPCF&gt;15000)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_35_0.png" src="../_images/capitulo2_35_0.png" />
</div>
</div>
<p>Las figuras 2.4 y 2.5 del texto pueden replicarse haciendo lo siguiente. En el primer caso, transformamos el ipcf a logaritmos con la función <code class="docutils literal notranslate"><span class="pre">log()</span></code> de <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>. Para el siguiente gráfico, se incrementa sucesivamente el número de barras del histograma. Para ello, podríamos repetir 4 veces el gráfico cambiando solamente la cantidad de bins. Sin embargo, como vimos en el caso del caso <code class="docutils literal notranslate"><span class="pre">describe()</span></code>, no resulta conveniente tener que repetir el bloque de códigos según cuantos bins queramos utilizar. Por lo que optamos por utilizar un <em>loop</em> o bucle que itera sobre el número de bins deseado. Por supuesto, el lector no familiarizado con los bucles puede optar por la opción de repetir el código cambiando el número de intervalos que desee, y si están interesados en introducirse en el método (lo cual verán que les ahorra mucho tiempo) pueden visitar <a class="reference external" href="https://www.w3schools.com/python/python_for_loops.asp"><em><strong>W3Schools</strong></em></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transformación logarítmica de ipcf</span>
<span class="n">lipcf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ipcf</span><span class="p">)</span>
<span class="c1"># Figura 2.4 - histograma logaritmo del ipcf </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lipcf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> 
        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Logaritmo ingreso per cápita familiar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Proporción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histograma Logaritmo IPCF-Mexico-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_37_0.png" src="../_images/capitulo2_37_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.5 - histogramas con diferente cantidad de intervalos</span>
<span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">style</span><span class="o">.</span><span class="n">green</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;Iteración </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> intervalos&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lipcf</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
        <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> intervalos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;logaritmo ingreso per cápita familiar&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;proporción&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green">Iteración 0: 10 intervalos</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Iteración 1: 50 intervalos</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Iteración 2: 100 intervalos</span>
<span class=" -Color -Color-Bold -Color-Bold-Green">Iteración 3: 1000 intervalos</span>
</pre></div>
</div>
<img alt="../_images/capitulo2_38_1.png" src="../_images/capitulo2_38_1.png" />
</div>
</div>
<p>Las líneas que siguen grafican, superpuestos, los histogramas suavizados de las funciones de densidad del logaritmo del ipcf para las regiones Noroeste y Sur de México. Para ello, nos moveremos hacia la librería <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>, interface basada en <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> para generar visualizaciones de una manera sencilla. A diferencia de <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, en el caso gráficos de histogramas suavizados, <code class="docutils literal notranslate"><span class="pre">sns.kdeplot()</span></code> de <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> admite el factor de expansión para generar los gráficos, por lo que se considera más adecuado mudarse a dicha librería para el resto de funciones que restan por hacer en este apartado. Si les interesa saber más acerca de la librería, pueden ir a <a class="reference external" href="https://seaborn.pydata.org/"><em><strong>seaborn</strong></em></a>.</p>
<p>Como se puede ver en los argumentos de <code class="docutils literal notranslate"><span class="pre">sns.kdeplot()</span></code>, el argumento <code class="docutils literal notranslate"><span class="pre">hue</span></code> le dice a <em>python</em> que considere el cálculo de densidades por separado según las categorías dentro de <em>region</em>, que en nuestro caso hemos realizado un filtro para quedarnos solamente con el Sur y Noroeste. Los demás argumentos responden a una cuestión estética. Se configura el color de manera manual a través del argumento <code class="docutils literal notranslate"><span class="pre">palette</span></code>, creando previamente una lista llamada también <em>palette</em> con dos colores exportados manualmente de <a class="reference external" href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3"><em><strong>ColorBrewer</strong></em></a> y se rellenan ambas áreas con <code class="docutils literal notranslate"><span class="pre">fill</span></code>. Por último, cabe aclarar que se desactiva <code class="docutils literal notranslate"><span class="pre">common_norm</span></code> que escala cada densidad por el número de observaciones tal que el área total de ambas densidades sume 1.</p>
<p>A su vez, definimos el objeto <em>lp</em> que contiene el valor de la línea de pobreza internacional de USD 2.5 por día por persona convertido a pesos mexicanos (en log), que marcamos como una línea vertical en el grafico con <code class="docutils literal notranslate"><span class="pre">plt.axvline()</span></code>. Como se puede ver, <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> al ser una especie de ramificación de <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> logra la compatibilidad con este último.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># recurso para ignorar warnings. Recomendado cuando es esperable un warning que no queremos mostrarlo porque no afecta los resultados</span>

<span class="c1"># Seteo de la línea de pobreza a graficar verticalmente</span>
<span class="n">lp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">608.425</span><span class="p">)</span>

<span class="c1"># Create an array with the colors you want to use</span>
<span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#1f78b4&#39;</span><span class="p">,</span><span class="s1">&#39;#fdc086&#39;</span><span class="p">]</span>

<span class="c1"># Filtro de regiones y transformación logarítmica</span>
<span class="n">df_temp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)]</span>
<span class="n">df_temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;lipcf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df_temp</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">## Figura 2.7 - histogramas superpuestos por regiones</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_temp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">lipcf</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span>  
            <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span> <span class="n">bw_method</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> 
            <span class="n">common_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">pondera</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Ingreso per cápita familiar&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Densidad&#39;</span><span class="p">,</span> 
       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Función de densidad del logaritmo del IPCF. Regiones Noroeste y Sur de México, 2006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Región&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sur&#39;</span><span class="p">,</span> <span class="s1">&#39;Noroeste&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">lp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_40_0.png" src="../_images/capitulo2_40_0.png" />
</div>
</div>
<p>Notar que en la transformación logarítmica del <em>ipcf</em> sumamos un 1 a la variable antes de transformarlo. Debido a que extraemos nuevamente la variable del <em>dataframe</em> la misma contiene valores nulos, por lo que para no obtener valores infinitos le aplicamos la transformación monónota <code class="docutils literal notranslate"><span class="pre">+1</span></code>, para que el logaritmo de los valores nulos termine siendo cero. Por supuesto, la misma responde a una opción alternativa a sacar los valores nulos directamente, antes de trabajar con <em>ipcf</em>.</p>
<p>Una de las ventajas de estos histogramas suavizados es facilitar las comparaciones. Como puede verse, las dos distribuciones son claramente diferentes. La distribución del Sur está desplazada a la izquierda, lo que sugiere que en general los individuos de esa región tienen menores ingresos que en el Noroeste y por lo tanto una densidad mayor caerá por debajo de la línea de pobreza fijada en esa región.</p>
<p>Por último, siguiendo la figura 2.6 y 2.8, se presenta un histograma con una versión “suavizada” del mismo en línea continua, calculado a través del método de kernels de la función. Posteriormente, repetimos el histograma anterior pero cambiamos la versión suavizada por el de una distribución normal con media y varianza idénticas a las de los datos reales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Figura 2.6 - histogramas superpuestos por regiones</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lipcf</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> 
            <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">),</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span>
            <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
            <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;proportion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Logaritmo IPCF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Proporción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histograma logaritmo IPCF-Mexico-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_42_0.png" src="../_images/capitulo2_42_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficamos la densidad estimada superpuesta con una distribucion normal teorica</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">lipcf</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">1</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">lipcf</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Figura 2.8 - histograma del ICPF y su distribución normal</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">lipcf</span> <span class="p">,</span> <span class="n">weights</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">pondera</span><span class="p">),</span> 
             <span class="n">bins</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> 
             <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;proportion&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span><span class="o">*</span><span class="mf">0.13</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;log IPCF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Densidad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_43_0.png" src="../_images/capitulo2_43_0.png" />
</div>
</div>
</section>
<section id="funcion-de-distribucion">
<h2>2.3 Función de distribución<a class="headerlink" href="#funcion-de-distribucion" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 77</strong></em></a></p>
<p>En este apartado se muestra cómo pueden graficarse las funciones de distribución presentadas en la sección 2.3.2 del cuerpo principal del capítulo. El primer paso para construir una función de distribución es ordenar (de menor a mayor) las observaciones de la encuestas, según la variable de ingreso elegida, <em>ipcf</em> en nuestro caso. Esto lo hacemos en la primera línea con la función <code class="docutils literal notranslate"><span class="pre">sort_values()</span></code>. En la línea siguiente se crea la variable <em>shrpop</em> para almacenar la proporción relativa acumulada de la variable pondera, es decir, el porcentaje acumulado de la población que representa cada observación junto con todas las anteriores. Así, la variable <em>shrpop</em> tendrá un valor de 100 para la última observación. Para obtener la suma acumulada expandida empleamos <code class="docutils literal notranslate"><span class="pre">cumsum()</span></code> y lo dividimos por el total de población expandida que se obtiene con <code class="docutils literal notranslate"><span class="pre">sum()</span></code>. La función de distribución de la Figura 2.9 presenta las variables <em>shrpop</em> e <em>ipcf</em> en los ejes vertical y horizontal, respectivamente, como se indica en <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ordenamos las observaciones de la base de acuerdo al IPCF</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">])</span>
<span class="c1"># Agregamos una columna que muestre la proporcion del ingreso que acumula cada individuo</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pondera</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">pondera</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> 
<span class="c1"># Creamos vectores para graficar</span>
<span class="n">shrpop</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span>
<span class="n">ipcf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.9 - función de distribución acumulada</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ipcf</span><span class="p">,</span> <span class="n">shrpop</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;IPCF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Proporción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Función de Distribución IPCF-Mexico-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_46_0.png" src="../_images/capitulo2_46_0.png" />
</div>
</div>
<p>Nuevamente, la cola superior larga de la distribución vuelve al gráfico poco útil. Para resolver este problema las alternativas son dos. Primero, podríamos truncar los valores superiores del ingreso. Segundo, trabajar en logaritmos. La figura 2.10 muestra ambas alternativas. Para la primera, calculamos el ingreso del percentil 95 y en base a este umbral filtramos las observaciones. En el segundo caso, transformamos a logaritmo el ingreso per cápita familiar, realizando un filtro previo de valores no nulos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replicamos el gráfico pero excluyendo al 5% mas rico</span>
<span class="n">shrpop_95</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shrpop</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.95</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)]</span>
<span class="n">ipcf_95</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ipcf</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.95</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)]</span>
<span class="n">lipcf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ipcf</span><span class="p">[</span><span class="n">ipcf</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">])</span>
<span class="n">shrpop</span> <span class="o">=</span> <span class="n">shrpop</span><span class="p">[</span><span class="n">lipcf</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 

<span class="c1"># Figura 2.10 función de distribución acumulada sin outliers</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ipcf_95</span><span class="p">,</span> <span class="n">shrpop_95</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;ingreso per cápita familiar&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;proporción&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Función de Distribución IPCF-Mexico-2006&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ignora 5% más rico&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lipcf</span><span class="p">,</span> <span class="n">shrpop</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;logaritmo del ingreso per cápita familiar&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;proporción&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Toda la población&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_48_0.png" src="../_images/capitulo2_48_0.png" />
</div>
</div>
<p>Se deja como ejercicio para el lector elaborar las otras funciones de distribución presentadas en la sección 2.3.2. Por su parte, la curva de Pen (ver figuras 2.12 y 2.13) se construye igual que la función de distribución pero se grafica invirtiendo los ejes.</p>
</section>
<section id="diagrama-de-pareto">
<h2>2.4 Diagrama de Pareto<a class="headerlink" href="#diagrama-de-pareto" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 78</strong></em></a></p>
<p>En esta sección se muestra cómo replicar la figura 2.14 del texto, que muestra los diagramas de Pareto para las regiones Noroeste y Sur de México. El procedimiento es muy similar al caso de la función de distribución ya que en esencia representan lo mismo, aunque desde una mirada alternativa. El gráfico de Pareto muestra para cada valor del ingreso <em>x</em> el porcentaje de la población que recibe ingresos superiores a ese valor <em>x</em>, en una escala doble logarítmica. El cambio de escala genera una suerte de zoom óptico sobre los estratos de mayores ingresos, permitiendo un examen más detallado de esa parte de la distribución.</p>
<p>Para graficarlo seguimos los pasos anteriores, pero ahora ordenamos a la población por ingreso dentro de cada región y ya no considerando el total país. Para ello agrupamos las observaciones por región con <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> previo a calcular el <em>share</em> acumulado, de forma tal que este cálculo se haga solo entre individuos de una misma región, a partir de la función <code class="docutils literal notranslate"><span class="pre">apply()</span></code> creamos la variable <em>shrpop_region</em>. La función junto con el argumento <code class="docutils literal notranslate"><span class="pre">lambda</span></code> permite crear funciones matemáticas “anónimas”. Para quien esté familiarizado con R, podría ser una suerte de <code class="docutils literal notranslate"><span class="pre">mutate()</span></code> de <code class="docutils literal notranslate"><span class="pre">dplyr</span></code>. Más información de la función puede encontrarse en <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html"><em><strong>pandas.DataFrame.apply</strong></em></a> y <a class="reference external" href="https://sparkbyexamples.com/pandas/pandas-apply-with-lambda-examples/#:~:text=apply()%20can%20be%20used,arguments%20and%20execute%20an%20expression."><em><strong>ejemplos</strong></em></a>.</p>
<p>En las siguientes líneas generamos dos variables. La primera es el logaritmo del <em>ipcf</em>, que va a ser el vector a graficar. En segundo lugar, la variable <em>lpareto</em>, que generamos a partir de la variable <em>shrpop_region</em>. Finalmente, se grafica filtrando la base para las regiones de interés y, siguiendo la misma lógica empleada en el gráfico de densidad superpuesta, a través de <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> con <code class="docutils literal notranslate"><span class="pre">ax.plot()</span></code> para ambas regiones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;divide by zero encountered in log&quot;</span><span class="p">)</span> <span class="c1"># ignorar si aparece advertencia de valores infinitos</span>

<span class="c1"># Ordenamos las observaciones por region e IPCF</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;ipcf&quot;</span><span class="p">])</span>

<span class="c1"># Definimos el logaritmo del IPCF</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;lipcf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Definimos la variable con la proporcion del ingreso acumulada por individuo pero por region</span>
<span class="c1"># df[&#39;pop_region&#39;] = df.groupby(by=[&quot;region&quot;])[&#39;pondera&#39;].cumsum()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;shrpop_region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">pondera</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">pondera</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># for i in np.unique(df[&quot;region&quot;]):</span>
<span class="c1">#    aux = df.loc[df[&quot;region&quot;] == i,&#39;shrpop&#39;].max() </span>
<span class="c1">#    df.loc[df[&quot;region&quot;] == i,&#39;shrpop&#39;] = df[&quot;shrpop&quot;] / aux</span>

<span class="c1"># Añadimos una columna con la variable para graficar la curva</span>
<span class="c1"># aux = 1 - df[&quot;shrpop_region&quot;]</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;lpareto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop_region&quot;</span><span class="p">])</span>

<span class="c1"># Creamos dos submuestras con las observaciones de las regiones Noroeste y Sur</span>
<span class="n">df_1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.14 - Diagrama de Pareto</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;lipcf&quot;</span><span class="p">],</span> <span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;lpareto&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Noroeste&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;lipcf&quot;</span><span class="p">],</span> <span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;lpareto&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Sur&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curvas de Pareto-Noroeste y Sur de México-2006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;lpareto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;logaritmo del ingreso per cápita familiar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_52_0.png" src="../_images/capitulo2_52_0.png" />
</div>
</div>
<p>Las líneas siguientes repiten el ejercicio pero dejando de lado al 1% más rico de la poblacion en cada región. Aquí en vez de filtrar en base al valor de ingresos, lo hacemos en base al porcentaje acumulado, como alternativa al caso anterior. Denominamos <em>cutoff</em> como el punto de corte y filtramos todos los valores cuyo <em>shrpop</em> sea menor a dicho umbral.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replicamos las curvas pero excluyendo al 1% mas rico de la poblacion de cada region</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="mf">0.99</span>
<span class="n">df_1</span> <span class="o">=</span> <span class="n">df_1</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">)]</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df_6</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">)]</span>

<span class="c1"># Gráfico - Diagrama de Pareto</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;lipcf&quot;</span><span class="p">],</span> <span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;lpareto&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Noroeste&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;lipcf&quot;</span><span class="p">],</span> <span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;lpareto&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Sur&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curvas de Pareto-Noroeste y Sur de México-2006&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;lpareto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;logaritmo del ingreso per cápita familiar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_54_0.png" src="../_images/capitulo2_54_0.png" />
</div>
</div>
</section>
<section id="box-plot">
<h2>2.5 Box-Plot<a class="headerlink" href="#box-plot" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 79</strong></em></a></p>
<p>Aquí se muestra cómo elaborar diagramas de caja o box-plot como los presentados en la sección 2.3.5 del texto. El problema con las librerías de boxplot disponibles es que no permiten la inclusión de factores de expansión, por lo que para graficar primero creamos nuestra propia función para computar los valores necesarios para armar el gráfico. La función se llama <code class="docutils literal notranslate"><span class="pre">box_plotInput()</span></code> y dentro calcula en primer lugar los percentiles ponderados, bajo un método de interpolación lineal similar al que construimos en la <a class="reference external" href="#2.1-Introducci%C3%B3n:-ejemplo-Brasil"><strong>Sección 2.1</strong></a>, donde utilizamos el método <a class="reference external" href="https://en.wikipedia.org/wiki/Percentile#Definition_of_the_Weighted_Percentile_method"><em><strong>weighted percentile method</strong></em></a>. A partir de los cuartiles necesarios la función calcula el rango intercuartílico de la serie de interés, y luego pasa a calcular los límites inferior y superior del diagrama.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">box_plotInput</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">percents</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Definimos una funcion para calcular cuantiles ponderados</span>
    <span class="k">def</span> <span class="nf">weighted_percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">percents</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">percents</span><span class="p">)</span>
        <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">d</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="n">p</span><span class="o">=</span><span class="mf">1.</span><span class="o">*</span><span class="n">w</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">/</span><span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
        <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">percents</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span>
    <span class="n">box_plotInput</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">percents</span><span class="p">:</span>
        <span class="n">box_plotInput</span><span class="p">[</span><span class="s2">&quot;p</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span> <span class="o">=</span> <span class="n">weighted_percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="c1"># Definimos el rango intercuartilico</span>
    <span class="n">iqr</span><span class="o">=</span><span class="n">box_plotInput</span><span class="p">[</span><span class="s1">&#39;p75&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">box_plotInput</span><span class="p">[</span><span class="s1">&#39;p25&#39;</span><span class="p">]</span> 

    <span class="c1"># Definimos limites inferior y superior</span>
    <span class="n">box_plotInput</span><span class="p">[</span><span class="s2">&quot;mini&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">box_plotInput</span><span class="p">[</span><span class="s1">&#39;p25&#39;</span><span class="p">]</span>  <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span>

    <span class="k">if</span> <span class="n">box_plotInput</span><span class="p">[</span><span class="s2">&quot;mini&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">box_plotInput</span><span class="p">[</span><span class="s2">&quot;mini&quot;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

    <span class="n">box_plotInput</span><span class="p">[</span><span class="s2">&quot;maxi&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">box_plotInput</span><span class="p">[</span><span class="s1">&#39;p75&#39;</span><span class="p">]</span>  <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">iqr</span>
    <span class="k">return</span> <span class="n">box_plotInput</span>
</pre></div>
</div>
</div>
</div>
<p>Con la función definida pasamos a extraer los vectores de interés, esto es, el <em>ipcf</em> y el factor de expansión <em>pondera</em>, con un previo ordenamiento en base al índice (utilizando <code class="docutils literal notranslate"><span class="pre">sort_index()</span></code>) para volver al order original de la base. Luego, con nuestra función custom <code class="docutils literal notranslate"><span class="pre">box_plotInput()</span></code> obtenemos los inputs necesarios para graficar. Así, pasamos a graficar la Figura 2.15 con <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. Se visualizan tanto el ipcf en valores reales (panel izquierdo) como su transformación logarítmica (panel derecho).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extraemos los datos del IPCF y los ponderadores y los convertimos en vectores para graficar</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">ipcf</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span>
<span class="n">pondera</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">]</span>

<span class="c1">## Generamos input para boxplot con nuestra función custom</span>
<span class="c1"># valores reales</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">box_plotInput</span><span class="p">(</span><span class="n">ipcf</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span> <span class="n">pondera</span><span class="p">)</span>
<span class="n">box_ipcf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inputs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="c1"># logaritmo</span>
<span class="n">lipcf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">inputs_log</span> <span class="o">=</span> <span class="n">box_plotInput</span><span class="p">(</span><span class="n">lipcf</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span> <span class="n">pondera</span><span class="p">)</span>
<span class="n">box_ipcf_log</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inputs_log</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="c1">## Figura 2.15 - Box Plot excluyendo outliers</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">box_ipcf</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;IPCF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;se excluyen valores atípicos&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> 
         <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Box Plot IPCF-Mexico-2006&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;valores reales&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">box_ipcf_log</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;IPCF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span><span class="o">-</span><span class="mf">0.03</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="s2">&quot;se excluyen valores atípicos&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
         <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;logaritmo&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_58_0.png" src="../_images/capitulo2_58_0.png" />
</div>
</div>
<p>Posteriormente, repetimos el ejercicio para las regiones Noroeste y Sur de México (Figura 2.17 del texto), pero utilizando la librería de visualización <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>. Notar también que para la Figura 2.17 no necesitamos generar <code class="docutils literal notranslate"><span class="pre">ax</span></code> como lo veníamos hacendo, ya que lo generamos directamente desde <code class="docutils literal notranslate"><span class="pre">sns.boxplot()</span></code> de <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Construimos graficos del log del IPCF por separado para las regiones Noroeste y Sur</span>
<span class="c1"># Creamos elementos necesarios para el grafico del Noroeste</span>
<span class="n">df_1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">lipcf_1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lipcf_1</span><span class="o">=</span><span class="n">lipcf_1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pondera_1</span> <span class="o">=</span> <span class="n">df_1</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span>
<span class="n">pondera_1</span><span class="o">=</span><span class="n">pondera_1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">inputs_1</span> <span class="o">=</span> <span class="n">box_plotInput</span><span class="p">(</span><span class="n">lipcf_1</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span> <span class="n">pondera_1</span><span class="p">)</span>
<span class="n">box_ipcf_1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inputs_1</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="c1"># Creamos elementos necesarios para el grafico del Sur</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">lipcf_6</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lipcf_6</span><span class="o">=</span><span class="n">lipcf_6</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pondera_6</span> <span class="o">=</span> <span class="n">df_6</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span>
<span class="n">pondera_6</span><span class="o">=</span><span class="n">pondera_6</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">inputs_6</span> <span class="o">=</span> <span class="n">box_plotInput</span><span class="p">(</span><span class="n">lipcf_6</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span> <span class="n">pondera_6</span><span class="p">)</span>
<span class="n">box_ipcf_6</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inputs_6</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">del</span> <span class="p">[</span><span class="n">df_1</span><span class="p">,</span> <span class="n">df_6</span><span class="p">]</span>

<span class="c1"># Unimos ambas regiones para graficar</span>
<span class="n">box_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Noroeste&#39;</span><span class="p">:</span> <span class="n">box_ipcf_1</span><span class="p">,</span>
                       <span class="s1">&#39;Sur&#39;</span><span class="p">:</span> <span class="n">box_ipcf_6</span><span class="p">})</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Figura 2.17  - Box Plot en log por regiones con outliers</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">box_df</span><span class="p">))</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Región&#39;</span><span class="p">,</span> 
            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;log ipcf&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_61_0.png" src="../_images/capitulo2_61_0.png" />
</div>
</div>
<p>Por último, repetimos los box-plots para ambas regiones, considerando las observacioens atípicas. No obstante, para este caso utilizamos la función <code class="docutils literal notranslate"><span class="pre">boxplot()</span></code> de <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> directamente, por lo que no utilizamos ponderadores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construimos los mismos graficos pero incluyendo los outliers (no utilizamos ponderadores)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">],</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Box Plot Log IPCF-Noroeste de México-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df_temp</span><span class="p">[</span><span class="s1">&#39;lipcf&#39;</span><span class="p">],</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Box Plot Log IPCF-Sur de México-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_63_0.png" src="../_images/capitulo2_63_0.png" />
</div>
</div>
</section>
<section id="curva-de-lorenz">
<h2>2.6 Curva de Lorenz<a class="headerlink" href="#curva-de-lorenz" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 80</strong></em></a></p>
<p>En este apartado se muestra cómo pueden construirse las curvas de Lorenz introducidas en la sección 2.3.6 del capítulo. El primer paso consiste en ordenar a los individuos de menor a mayor según su ingreso (en nuestro caso contenido en la variable <em>ipcf</em>) y contemplando el orden del factor de expansión. Las líneas siguientes generan la variable <em>shrpop</em> de la misma forma en la que fue generada más arriba, estimando la proporción de la población que se acumula hasta cada observación de la encuesta. La diferencia es que ahora también generaremos una variable <em>shrinc</em> que contiene la proporción del ingreso que se acumula hasta cada observación y que se estima expandiendo el ingreso por el ponderador, es decir multiplicando ambas columnas, como puede verse en el código.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ordenamos las observaciones segun el IPCF y el ponderador</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">,</span><span class="s2">&quot;pondera&quot;</span><span class="p">])</span>
<span class="c1">#Añadimos una columna con la proporción acumulada que representa cada individuo del total de la población</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">shr_N</span> <span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">shr_N</span>
<span class="c1">#Añadimos una variable análoga pero con el ingreso acumulado</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">shr_N</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">shr_N</span>
</pre></div>
</div>
</div>
</div>
<p>La curva de Lorenz nos muestra qué porcentaje de la población acumula un porcentaje dado del ingreso total. Para visualizarlo indicamos entonces los ejes respectivos para <em>shrpop</em> y <em>shrinc</em> a la función <code class="docutils literal notranslate"><span class="pre">plot()</span></code> de <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, como también, graficamos la línea de perfecta igualdad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.18 - curva de Lorenz </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span><span class="s2">&quot;Curva de Lorenz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;proporción acumulada de la población&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;proporción acumulada del ingreso&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Línea de Perfecta Igualdad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curva de Lorenz del IPCF-Mexico-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_67_0.png" src="../_images/capitulo2_67_0.png" />
</div>
</div>
<p>En las líneas siguientes se comparan las curvas de Lorenz para las dos regiones de México que venimos analizando. El código sigue los mismos pasos que antes pero ahora los cálculos de población e ingreso acumulado se realizan a partir <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> de <code class="docutils literal notranslate"><span class="pre">pandas</span></code> para diferenciar regiones. Mientras que <em>shrpop</em> y <em>shrinc</em> se calculan a partir de bucles sobre cada región.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos variable de proporcion de poblacion acumulada en cada region</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]):</span> 
   <span class="n">aux2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> 
   <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">aux2</span>

<span class="c1"># Definimos variable analoga pero con el ingreso acumulado por region</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;aux&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;shrinc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])[</span><span class="s1">&#39;aux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]):</span>
   <span class="n">aux2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;shrinc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> 
   <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;shrinc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">aux2</span>

<span class="c1"># Definimos los elementos necesarios para graficar    </span>
<span class="n">df_1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">df_1</span> <span class="o">=</span> <span class="n">df_1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">])</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df_6</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.19 - curva de lorenz por regiones</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">],</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Noroeste&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">],</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;shrinc&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sur&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Proporción acumulada de la población&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Proporción acumulada del ingreso&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Línea de Perfecta Igualdad&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curvas de Lorenz del IPCF-Noroeste y Sur de México-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_70_0.png" src="../_images/capitulo2_70_0.png" />
</div>
</div>
</section>
<section id="curva-generalizada-de-lorenz">
<h2>2.7 Curva Generalizada de Lorenz<a class="headerlink" href="#curva-generalizada-de-lorenz" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 81</strong></em></a></p>
<p>La curva generalizada de Lorenz se construye a partir de la curva de Lorenz pero multiplicando su eje vertical por el ingreso promedio (ver sección 2.3.6 en el cuerpo del capítulo). Las líneas de código no se modifican respecto de las utilizadas para estimar la curva de Lorenz, salvo en que ahora la variable <em>shrpop</em> la generamos sobre la base de la variable <em>pondera</em>. Para entender el álgebra detrás de esta forma de calcular la curva generalizada de Lorenz, el lector puede remitirse a los apéndices del libro (pagina 81-82) donde queda claramente explicitado. Recordar que la curva generalizada de Lorenz muestra el ingreso acumulado en el x% más pobre de la población, sobre el número de personas. Como quedará mas claro en los capítulos 6 y 7, mientras que la curva de Lorenz se emplea para estudiar desigualdad, la generalizada de Lorenz es muy útil para analizar bienestar agregado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos variable de proporcion de poblacion acumulada en cada region</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]):</span>
   <span class="n">aux2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> 
   <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">aux2</span>

<span class="c1"># Definimos la variable correspondiente a la curva generalizada de Lorenz</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;aux&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;pondera&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;glorenz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])[</span><span class="s1">&#39;aux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]):</span>
   <span class="n">aux2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> 
   <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;glorenz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;glorenz&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">aux2</span>

<span class="c1"># Definimos los elementos necesarios para graficar    </span>
<span class="n">df_1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">df_6</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.20 - curva de Lorenz generalizada por regiones</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">],</span><span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;glorenz&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Noroeste&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">],</span><span class="n">df_6</span><span class="p">[</span><span class="s2">&quot;glorenz&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sur&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Proporción acumulada de la población&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Curva Generalizada de Lorenz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curvas Generalizadas de Lorenz del IPCF-Noroeste y Sur de México-2006&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_73_0.png" src="../_images/capitulo2_73_0.png" />
</div>
</div>
</section>
<section id="curva-de-incidencia-del-crecimiento">
<h2>2.8 Curva de incidencia del crecimiento<a class="headerlink" href="#curva-de-incidencia-del-crecimiento" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://drive.google.com/file/d/1MwQrMylnYL0VHrLRM3JafsCBE9NkisAJ/view"><em><strong>Página 83</strong></em></a></p>
<p>En este apartado se muestra cómo pueden estimarse las curvas de incidencia del crecimiento que aparecen en la figura 2.21 del texto. A modo de ejemplo, se computa la curva de incidencia del crecimiento para Argentina entre 1992 y 2006, utilizando percentiles del ingreso per cápita familiar. A continuación, cargamos ambas bases, esto es, la EPH puntual de 1992 y la del segundo semestre de 2006. Para el primer caso, la forma de importar el <em>dataset</em> es diferente. Debido a que el archivo no se encuentra en la página del cedlas, lo obtenemos desde <em>google drive</em> a partir del procedimiento que se muestra a continuación. Creamos una variable llamada <em>aux</em> que contiene el enlace de descarga. Posteriormente, la variable <em>link</em> se conforma de una parte estándar para descargar archivos a partir del <em>id</em> de los archivos, más una segunda parte que identifica el id dentro de <em>aux</em>. Con el enlace <em>link</em> establecido, pasamos a importar el <em>.dta</em> con <code class="docutils literal notranslate"><span class="pre">read_stata()</span></code>, pero solamente seleccionando las columnas que nos interesa, con el argumento <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># descargamos el archivo zip de eph puntual 1992</span>
<span class="n">aux</span> <span class="o">=</span> <span class="s2">&quot;https://drive.google.com/file/d/1ICi2BF3YkQt2a_fBkxt00CV1_ipmsEIP/view?usp=sharing&quot;</span>
<span class="n">link</span> <span class="o">=</span><span class="s1">&#39;https://drive.google.com/uc?id=&#39;</span> <span class="o">+</span> <span class="n">aux</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">df_92</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">,</span> <span class="s1">&#39;pondera&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;cohh&#39;</span><span class="p">])</span> <span class="c1"># nos quedamos con las columnas de interés</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\USUARIO\AppData\Roaming\Python\Python310\site-packages\pandas\io\stata.py:1514: UnicodeWarning: 
One or more strings in the dta file could not be decoded using utf-8, and
so the fallback encoding of latin-1 is being used.  This can happen when a file
has been incorrectly encoded by Stata or some other software. You should verify
the string values returned are correct.
  warnings.warn(msg, UnicodeWarning)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># descargamos el archivo zip de eph 2006 segundo semestre</span>
<span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://www.cedlas.econo.unlp.edu.ar/wp/wp-content/uploads/arg06.zip&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">fileName</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># descomprimimos y eliminamos el archivo .zip</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
     <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
<span class="c1"># cargamos el arcivho .dta</span>
<span class="n">df_06</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.dta&#39;</span><span class="p">)</span> 
<span class="n">df_06</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0% [                                                                            ]      0 / 474916
  1% [.                                                                           ]   8192 / 474916
  3% [..                                                                          ]  16384 / 474916
  5% [...                                                                         ]  24576 / 474916
  6% [.....                                                                       ]  32768 / 474916
  8% [......                                                                      ]  40960 / 474916
 10% [.......                                                                     ]  49152 / 474916
 12% [.........                                                                   ]  57344 / 474916
 13% [..........                                                                  ]  65536 / 474916
 15% [...........                                                                 ]  73728 / 474916
 17% [.............                                                               ]  81920 / 474916
 18% [..............                                                              ]  90112 / 474916
 20% [...............                                                             ]  98304 / 474916
 22% [.................                                                           ] 106496 / 474916
 24% [..................                                                          ] 114688 / 474916
 25% [...................                                                         ] 122880 / 474916
 27% [....................                                                        ] 131072 / 474916
 29% [......................                                                      ] 139264 / 474916
 31% [.......................                                                     ] 147456 / 474916
 32% [........................                                                    ] 155648 / 474916
 34% [..........................                                                  ] 163840 / 474916
 36% [...........................                                                 ] 172032 / 474916
 37% [............................                                                ] 180224 / 474916
 39% [..............................                                              ] 188416 / 474916
 41% [...............................                                             ] 196608 / 474916
 43% [................................                                            ] 204800 / 474916
 44% [..................................                                          ] 212992 / 474916
 46% [...................................                                         ] 221184 / 474916
 48% [....................................                                        ] 229376 / 474916
 50% [......................................                                      ] 237568 / 474916
 51% [.......................................                                     ] 245760 / 474916
 53% [........................................                                    ] 253952 / 474916
 55% [.........................................                                   ] 262144 / 474916
 56% [...........................................                                 ] 270336 / 474916
 58% [............................................                                ] 278528 / 474916
 60% [.............................................                               ] 286720 / 474916
 62% [...............................................                             ] 294912 / 474916
 63% [................................................                            ] 303104 / 474916
 65% [.................................................                           ] 311296 / 474916
 67% [...................................................                         ] 319488 / 474916
 68% [....................................................                        ] 327680 / 474916
 70% [.....................................................                       ] 335872 / 474916
 72% [.......................................................                     ] 344064 / 474916
 74% [........................................................                    ] 352256 / 474916
 75% [.........................................................                   ] 360448 / 474916
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 77% [..........................................................                  ] 368640 / 474916
 79% [............................................................                ] 376832 / 474916
 81% [.............................................................               ] 385024 / 474916
 82% [..............................................................              ] 393216 / 474916
 84% [................................................................            ] 401408 / 474916
 86% [.................................................................           ] 409600 / 474916
 87% [..................................................................          ] 417792 / 474916
 89% [....................................................................        ] 425984 / 474916
 91% [.....................................................................       ] 434176 / 474916
 93% [......................................................................      ] 442368 / 474916
 94% [........................................................................    ] 450560 / 474916
 96% [.........................................................................   ] 458752 / 474916
 98% [..........................................................................  ] 466944 / 474916
100% [............................................................................] 474916 / 474916
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [41],</span> in <span class="ni">&lt;cell line: 10&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># cargamos el arcivho .dta</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">df_06</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s1">.dta&#39;</span><span class="p">)</span> 
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">df_06</span>

<span class="nn">File ~\AppData\Roaming\Python\Python310\site-packages\pandas\io\stata.py:2004,</span> in <span class="ni">read_stata</span><span class="nt">(filepath_or_buffer, convert_dates, convert_categoricals, index_col, convert_missing, preserve_dtypes, columns, order_categoricals, chunksize, iterator, compression, storage_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">1988</span> <span class="nd">@Appender</span><span class="p">(</span><span class="n">_read_stata_doc</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1989</span> <span class="k">def</span> <span class="nf">read_stata</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1990</span>     <span class="n">filepath_or_buffer</span><span class="p">:</span> <span class="n">FilePath</span> <span class="o">|</span> <span class="n">ReadBuffer</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2001</span>     <span class="n">storage_options</span><span class="p">:</span> <span class="n">StorageOptions</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2002</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span> <span class="o">|</span> <span class="n">StataReader</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2004</span>     <span class="n">reader</span> <span class="o">=</span> <span class="n">StataReader</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2005</span>         <span class="n">filepath_or_buffer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2006</span>         <span class="n">convert_dates</span><span class="o">=</span><span class="n">convert_dates</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2007</span>         <span class="n">convert_categoricals</span><span class="o">=</span><span class="n">convert_categoricals</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2008</span>         <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2009</span>         <span class="n">convert_missing</span><span class="o">=</span><span class="n">convert_missing</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2010</span>         <span class="n">preserve_dtypes</span><span class="o">=</span><span class="n">preserve_dtypes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2011</span>         <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2012</span>         <span class="n">order_categoricals</span><span class="o">=</span><span class="n">order_categoricals</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2013</span>         <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2014</span>         <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2015</span>         <span class="n">compression</span><span class="o">=</span><span class="n">compression</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2016</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2018</span>     <span class="k">if</span> <span class="n">iterator</span> <span class="ow">or</span> <span class="n">chunksize</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2019</span>         <span class="k">return</span> <span class="n">reader</span>

<span class="nn">File ~\AppData\Roaming\Python\Python310\site-packages\pandas\io\stata.py:1151,</span> in <span class="ni">StataReader.__init__</span><span class="nt">(self, path_or_buf, convert_dates, convert_categoricals, index_col, convert_missing, preserve_dtypes, columns, order_categoricals, chunksize, compression, storage_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">1148</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lines_read</span> <span class="o">=</span> <span class="mi">0</span>
<span class="g g-Whitespace">   </span><span class="mi">1150</span> <span class="bp">self</span><span class="o">.</span><span class="n">_native_byteorder</span> <span class="o">=</span> <span class="n">_set_endianness</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">byteorder</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1151</span> <span class="k">with</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1152</span>     <span class="n">path_or_buf</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1153</span>     <span class="s2">&quot;rb&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1154</span>     <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1155</span>     <span class="n">is_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1156</span>     <span class="n">compression</span><span class="o">=</span><span class="n">compression</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1157</span> <span class="p">)</span> <span class="k">as</span> <span class="n">handles</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1158</span>     <span class="c1"># Copy to BytesIO, and ensure no encoding</span>
<span class="g g-Whitespace">   </span><span class="mi">1159</span>     <span class="bp">self</span><span class="o">.</span><span class="n">path_or_buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="g g-Whitespace">   </span><span class="mi">1161</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_header</span><span class="p">()</span>

<span class="nn">File ~\AppData\Roaming\Python\Python310\site-packages\pandas\io\common.py:795,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">786</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">787</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>         <span class="c1"># Binary mode</span>
<span class="ne">--&gt; </span><span class="mi">795</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span> <span class="c1"># Convert BytesIO or file objects passed with an encoding</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;arg06 (1).dta&#39;
</pre></div>
</div>
</div>
</div>
<p>Una vez cargadas ambas bases seguimos los siguientes pasos. Primero filtramos los ingresos nulos y observaciones no coherentes (esto último para el caso de la EPH de 1992). Luego, ajustamos el ipcf de 1992 de acuerdo a la variación de precios observado entre ambos períodos. Una vez que tenemos las bases listas generamos la variable <em>percentil</em> en ambos <em>datasets</em> a partir de un bucle de 100 repeticiones para ambas encuestas de hogares. Cada una de las repeticiones asignará los percentiles en base a <em>shrpop</em> ayudándose de la variable z multiplicada por 0.01. La razón es sencilla: si queremos generar percentiles (n=100) necesitamos 100 cuantiles, por lo que cada cuantil se asigna por intervalos de población acumulada iguales a 0.01 (1/100). Así, por ejemplo, cuando z sea igual a 20, (z-1)<em>0.01 será igual a 0.19 y z</em>0.01 a 0.20, por lo que caerán en este cuantil veinte todos aquellos individuos que, ordenados por ingreso, estén entre el 19 y el 20 por ciento de población acumulada.</p>
<p>Una vez generado <em>percentil</em> agrupamos el ipcf promediando a este según el cuantil al que pertenezca con la función <code class="docutils literal notranslate"><span class="pre">groupby()</span></code>. Posteriormente, unimos ambas bases agregadas por <em>percentil</em>, renombramos las columnas y creamos la variable <em>change</em>, que representa la variación del ingreso promedio de cada cuantil entre 1992 y 2006. ¿Se podría ejecutar toda la rutina en un bucle para ambas bases? La respuesta es siempre sí. A los curiosos deja como ejercicio implementar un <em>loop</em> para los curiosos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Excluimos las observaciones con IPCF igual a 0 o incoherentes</span>
<span class="n">df_92</span> <span class="o">=</span> <span class="n">df_92</span><span class="p">[</span><span class="n">df_92</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">df_92</span> <span class="o">=</span> <span class="n">df_92</span><span class="p">[</span><span class="n">df_92</span><span class="p">[</span><span class="s1">&#39;cohh&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">df_06</span> <span class="o">=</span> <span class="n">df_06</span><span class="p">[</span><span class="n">df_06</span><span class="p">[</span><span class="s1">&#39;ipcf&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Actualizamos el IPCF de 1992 de acuerdo a la variacion de precios observada entre ambos periodos</span>
<span class="n">df_92</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">df_92</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">2.0994</span>

<span class="c1">## Construimos percentiles del IPCF en cada encuesta</span>
<span class="c1"># Ordenamos las observaciones segun el IPCF</span>
<span class="n">df_92</span><span class="o">=</span> <span class="n">df_92</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">])</span>
<span class="n">df_06</span><span class="o">=</span> <span class="n">df_06</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ipcf&quot;</span><span class="p">])</span>

<span class="c1"># Construimos una variable que indique la proporcion acumulada que cada individuo representa de la poblacion total</span>
<span class="n">df_92</span><span class="p">[</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_92</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">df_92</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">df_06</span><span class="p">[</span><span class="s1">&#39;shrpop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_06</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">df_06</span><span class="p">[</span><span class="s1">&#39;pondera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># Construimos los percentiles del IPCF</span>
<span class="n">df_92</span><span class="p">[</span><span class="s1">&#39;percentil&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df_06</span><span class="p">[</span><span class="s1">&#39;percentil&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span> 
    <span class="n">df_92</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_92</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_92</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">j</span><span class="o">*</span><span class="mf">0.01</span><span class="p">),</span><span class="s1">&#39;percentil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> 
    <span class="n">df_06</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_06</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_06</span><span class="p">[</span><span class="s2">&quot;shrpop&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">j</span><span class="o">*</span><span class="mf">0.01</span><span class="p">),</span><span class="s1">&#39;percentil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
    
<span class="c1"># Creamos vectores con el ingreso promedio por percentil para cada año</span>
<span class="n">df_92</span><span class="o">.</span><span class="n">agg</span> <span class="o">=</span> <span class="n">df_92</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;percentil&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;ipcf&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">})</span>
<span class="n">df_06</span><span class="o">.</span><span class="n">agg</span> <span class="o">=</span> <span class="n">df_06</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;percentil&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;ipcf&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">})</span>

<span class="c1"># Unimos los vectores en un data frame para calcular el cambio</span>
<span class="n">df_92_06</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_92</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span> <span class="n">df_06</span><span class="o">.</span><span class="n">agg</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>

<span class="c1"># Asignamos nombres a las columnas del data frame</span>
<span class="n">df_92_06</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ipcf_92&#39;</span><span class="p">,</span> <span class="s1">&#39;ipcf_06&#39;</span><span class="p">]</span>

<span class="c1"># Calculamos la variación entre el ingreso promedio de los dos periodos para cada percentil</span>
<span class="n">df_92_06</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df_92_06</span><span class="p">[</span><span class="s1">&#39;ipcf_06&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df_92_06</span><span class="p">[</span><span class="s1">&#39;ipcf_92&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>A partir de <em>change</em> graficamos la curva de incidencia del crecimiento para Argentina en el período 1992-2006 con <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figura 2.21 - Curva de incidencia ipcf</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_92_06</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;percentil del IPCF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;variación (%)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curva de incidencia del crecimiento-Argentina (1992-2006)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/capitulo2_80_0.png" src="../_images/capitulo2_80_0.png" />
</div>
</div>
<p>En el caso particular de esta figura, las magnitudes son diferentes a los reportados orginalmente en el capitulo del libro, pero las interpretaciones se mantienen. La tasa de crecimiento del ingreso real está completamente por debajo del eje horizontal, denotando una pérdida de ingresos reales, que dada la pendiente positiva de la curva implica caídas proporcionales del ingreso más grandes a medida que vamos descendiendo hacia estratos más pobres de la distribución. Es claro que la desigualdad de ingresos debe haber aumentado en Argentina en ese período.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./sections"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Apéndices del Libro Pobreza y Desigualdad en Python</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="capitulo3.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Capítulo 3</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bonavida Cristian, Laguinge Luis, Staudt Agustin y Varsavino Joaquín<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>